<div class="menu">
    <ul 
        nz-menu 
        nzMode="horizontal" 
    >
        <li nz-menu-item nzMatchRouter="#">
            <a style="font-size: 13px;" routerLink="/welcome/controleQualidade/dashControle">In√≠cio</a>
        </li>
        <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-submenu nzTitle="Cadastros "  style="font-size: 13px; ">
            <ul>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/tipoEnsaio">Tipo de Ensaio</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/variavel">Vari√°veis de Ensaio</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/ensaio" >Ensaio</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/calculoEnsaio" >C√°lculo de Ensaio</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/plano" >Plano de An√°lise</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/tipoAmostra" >Tipo de Amostra</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/produtoAmostra" >Produto de Amostra</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/garantia" >Garantias</a>
                </li>
            </ul>
        </li >
        <li nz-menu-item nzMatchRouter="#" *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])">
            <a style="font-size: 13px;" routerLink="/welcome/controleQualidade/amostra">Amostras</a>
        </li>

        <li nz-menu-item nzMatchRouter="#" *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])">
            <a style="font-size: 13px;" routerLink="/welcome/controleQualidade/ordem">Ordens de Servi√ßo</a>
        </li>

        <li nz-menu-item nzMatchRouter="#" *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])">
            <a style="font-size: 13px;" routerLink="/welcome/controleQualidade/arquivo">Banco de An√°lises</a>
        </li>

        <li nz-menu-item nzMatchRouter="#" *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])">
            <a style="font-size: 13px;">Banco de Relat√≥rios</a>
        </li>
    </ul>
</div>

<div class="container flex flex-column align-items-center mb-4">
    <div class="containerInterno w-12">
        <div @swipeAnimation>
            <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                <div class="fg1 flex flex-column w-12 align-items-center">
                    <p-card class="card w-12 text-left">
                        <ng-template #header>
                            <div class="header titulo-info w-full text-center">
                                <h2>Ordens de Servi√ßo</h2>
                            </div>
                        </ng-template>
                        <p-inplace closable="true" closeIcon="pi pi-angle-up">
                            <ng-template pTemplate="display">
                                <p-button 
                                    label="Formul√°rio de OS" 
                                    tooltipPosition="top"
                                    pTooltip="Formul√°rio de OS"
                                    severity="success"    
                                >
                                    <div class="inline-flex align-items-center">
                                        <span><i class="pi pi-angle-down"></i></span>
                                    </div>
                                </p-button>
                            </ng-template>
                            <ng-template pTemplate="content">
                                <form [formGroup]="registerOrdemForm" 
                                      title="Cadastrar nova Ordem de Servi√ßo"
                                      class="flex flex-column"
                                >                 
                                    <div 
                                        class="step1 flex flex-column w-12 gap-3 justify-content-center lg:flex-row"
                                    >
                                        <div class="bloco flex flex-column align-items-center w-6">
                                            <div class="w-11 m-2">
                                                <p-floatlabel variant="on">
                                                    <p-iconfield>
                                                        <p-inputicon class="pi pi-file-edit" />
                                                        <input variant="filled" [style]="{'width':'100%'}" pInputText id="on_label"
                                                            autocomplete="off" formControlName="numero" type="text" />
                                                    </p-iconfield>
                                                    <label for="on_label">N√∫mero</label>
                                                </p-floatlabel>
                                            </div>            
                                            <div class="w-11 text-left m-2">
                                                <p-floatLabel variant="on">
                                                    <p-datepicker 
                                                        variant="filled" 
                                                        [style]="{'width':'100%'}" 
                                                        id="da"
                                                        formControlName="data" 
                                                        dateFormat="dd/mm/yy" 
                                                        inputId="float-label"
                                                        [showIcon]="true"
                                                    >
                                                    </p-datepicker>
                                                    <label for="float-label">Data de Abertura</label>
                                                </p-floatLabel>
                                            </div>
                                        </div>
                                        <div class="bloco flex flex-column align-items-center w-6">    
                                            <div class="w-11 text-left m-2" *ngIf="!isOrdemExpressa">
                                                <p-floatLabel variant="on">
                                                    <p-select 
                                                        inputId="float-label" 
                                                        [style]="{'width':'100%'}"
                                                        [options]="planosAnalise" 
                                                        formControlName="planoAnalise"
                                                        optionLabel="descricao" 
                                                        optionValue="id" 
                                                        appendTo="body" 
                                                        [filter]="true"
                                                        filterBy="nome" 
                                                        [showClear]="true"
                                                    >
                                                    </p-select>
                                                    <label for="float-label">Selecione o Plano de An√°lise</label>
                                                </p-floatLabel>
                                            </div>

                                            <div class="w-11 text-left m-2">
                                                <p-floatLabel variant="on">
                                                    <p-select 
                                                        inputId="float-label" 
                                                        [style]="{'width':'100%'}"
                                                        [options]="responsaveis" 
                                                        formControlName="responsavel" 
                                                        optionLabel="value"
                                                        optionValue="value" 
                                                        appendTo="body" 
                                                        [filter]="true" 
                                                        filterBy="value"
                                                        [showClear]="true"
                                                    >
                                                    </p-select>
                                                    <label for="float-label">Selecione o Respons√°vel</label>
                                                </p-floatLabel>
                                            </div>
                                        </div>
                                    </div>
                                    <div 
                                        class="flex flex-column w-12 mb-3 mt-5 lg:flex-row"
                                    >
                                        <div class=" flex w-12 gap-3 justify-content-center">
                                            <p-button 
                                                label="Gerar OS" 
                                                severity="success" 
                                                icon="pi pi-check" 
                                                iconPos="right"
                                                (onClick)="criarOrdemComAmostra()" 
                                            />
                                        </div>
                                    </div>
                                </form>
                            </ng-template>
                        </p-inplace>
                        <div class="step1 flex flex-column w-12 gap-3 mt-3">
                            <div class="bloco w-12 text-left">
                                <p-table 
                                    #dt1
                                    sortField="id"
                                    [sortOrder]="-1"
                                    [value]="analisesFiltradas"
                                    [paginator]="true"
                                    [rows]="30"
                                    [rowsPerPageOptions]="[20, 30, 50]"
                                    [globalFilterFields]="[
                                        'data_entrada',
                                        'fornecedor',
                                        'numero',
                                        'status',
                                        'responsavel',
                                        'laboratorio'
                                    ]"
                                    [loading]="loading"
                                >
                                    <ng-template pTemplate="caption">
                                    <div class="step1 flex flex-column w-12 justify-content-between lg:w-12 lg:flex-row">
                                        <div class="w-2 text-left">
                                        </div>
                                        <div class="w-4' text-left">
                                        </div>
                                        <div class=" flex w-4 gap-3 justify-content-end text-right">
                                            <p-floatlabel variant="on">
                                                <p-iconfield>
                                                    <p-inputicon class="pi pi-search" style="color: #1b91ff;" />
                                                    <input 
                                                        variant="filled" 
                                                        [(ngModel)]="inputValue"
                                                        [style]="{'width':'100%'}" 
                                                        pInputText id="on_label"
                                                        autocomplete="off" 
                                                        type="text" 
                                                        (input)="filterTable()"
                                                    />
                                                </p-iconfield>
                                                <label for="on_label" style="color: #1b91ff">Pesquisar</label>
                                            </p-floatlabel>
                                        </div>
                                    </div>
                                    </ng-template>
                                    <ng-template pTemplate="header">
                                        <tr class="tabela">
                                            <th style="width: 10%; text-align: left;">
                                                <p-multiselect
                                                    [(ngModel)]="materiaisSelecionados"
                                                    [options]="materiaisFiltro"
                                                    (onChange)="filtrarPorMateriais()"
                                                    placeholder="Material"
                                                    [showClear]="true"
                                                    optionLabel="label"
                                                    optionValue="value"
                                                    [maxSelectedLabels]="3"
                                                    appendTo="body"
                                                >
                                                    <ng-template pTemplate="selectedItems" let-selectedOptions>
                                                        <div class="flex gap-1 flex-wrap">
                                                        <p-tag
                                                            *ngFor="let option of selectedOptions"
                                                            [value]="option.value"
                                                            [severity]="getSeverity(option.value)"
                                                        />
                                                        </div>
                                                    </ng-template>
                                                    <ng-template pTemplate="item" let-option>
                                                        <p-tag [value]="option.value" [severity]="getSeverity(option.value)" />
                                                    </ng-template>
                                                </p-multiselect>
                                            </th>
                                            <th style="width: 25%; text-align: left;" type="text"field="fornecedor" display="menu">Produto</th>
                                            <th style="width: 15%; text-align: left;" type="text"field="fornecedor" display="menu">N√∫mero</th>
                                            <th pSortableColumn="data_entrada" style="width: 10%;">
                                                <div class="flex justify-between items-left">
                                                    Data de Abertura
                                                    <p-sortIcon field="data_entrada" />
                                                    <p-columnFilter 
                                                        type="date" 
                                                        field="data_entrada" 
                                                        display="menu"  
                                                        class="ml-auto" 
                                                        showMenu="false" />
                                                </div>
                                            </th>
                                            <!-- <th style="width: 10%; text-align: left;" type="text" field="numero" display="menu">Classifica√ß√£o da OS</th> -->
                                            <th style="width: 10%; text-align: left;" type="text" field="responsavel" display="menu">Respons√°vel</th>
                                            <th style="width: 10%; text-align: left;" type="text" field="responsavel" display="menu">
                                                <p-multiselect
                                                    [(ngModel)]="tipoSelecionados"
                                                    [options]="tipoFiltro"
                                                    (onChange)="filtrarPorTipo()"
                                                    placeholder="Tipo"
                                                    [showClear]="true"
                                                    optionLabel="label"
                                                    optionValue="value"
                                                    [maxSelectedLabels]="3"
                                                    appendTo="body"
                                                >
                                                    <ng-template pTemplate="selectedItems" let-selectedOptions>
                                                        <div class="flex gap-1 flex-wrap">
                                                            <p-tag
                                                                *ngFor="let option of selectedOptions"
                                                                [value]="option.value"
                                                                [severity]="getTipoOrdem(option.value)"
                                                            />
                                                        </div>
                                                    </ng-template>
                                                    <ng-template pTemplate="item" let-option>
                                                        <p-tag [value]="option.value" [severity]="getTipoOrdem(option.value)" />
                                                    </ng-template>
                                                </p-multiselect>
                                            </th>
                                            <th style="width: 8%; text-align: left;">
                                                <p-multiselect
                                                    [(ngModel)]="laboratoriosSelecionados"
                                                    [options]="laboratoriosFiltro"
                                                    (onChange)="filtrarPorLaboratorios()"
                                                    placeholder="Laborat√≥rio"
                                                    [showClear]="true"
                                                    optionLabel="label"
                                                    optionValue="value"
                                                    [maxSelectedLabels]="3"
                                                    appendTo="body"
                                                >
                                                    <ng-template pTemplate="selectedItems" let-selectedOptions>
                                                        <div class="flex gap-1 flex-wrap">
                                                            <p-tag
                                                                *ngFor="let option of selectedOptions"
                                                                [value]="option.value"
                                                                [severity]="getLaboratorioSeverity(option.value)"
                                                            />
                                                        </div>
                                                    </ng-template>
                                                    <ng-template pTemplate="item" let-option>
                                                        <p-tag [value]="option.value" [severity]="getLaboratorioSeverity(option.value)" />
                                                    </ng-template>
                                                </p-multiselect>
                                            </th>
                                            <th style="width: 12%; text-align: center;" type="text" field="acoes"display="menu">Op√ß√µes</th>
                                        </tr>
                                    </ng-template>
  
                                    <ng-template pTemplate="loadingbody">
                                        <tr *ngFor="let s of [1,2,3,4,5,6,7,8,9,10]">
                                            <td><p-skeleton width="80px" height="18px" /></td>
                                            <td><p-skeleton width="100px" height="18px" /></td>
                                            <td><p-skeleton width="90px" height="18px" /></td>
                                            <td><p-skeleton width="120px" height="18px" /></td>
                                            <td><p-skeleton width="140px" height="18px" /></td>
                                            <td><p-skeleton width="70px" height="18px" /></td>
                                            <td>
                                                <div class="flex justify-content-center gap-2">
                                                    <p-skeleton width="30px" height="30px" shape="circle" />
                                                    <p-skeleton width="30px" height="30px" shape="circle" />
                                                    <p-skeleton width="30px" height="30px" shape="circle" />
                                                </div>
                                            </td>
                                        </tr>
                                    </ng-template>

                                    <ng-template pTemplate="body" let-analise>
                                        <tr>
                                            <td style="text-align: left;">
                                                <p-tag
                                                  [value]="analise.amostra_detalhes?.material"
                                                  [severity]="getSeverity(analise.amostra_detalhes?.material)"
                                                />
                                            </td>
                                            <td style="text-align: left;"> {{ analise.amostra_detalhes?.produto_amostra_detalhes.nome }} </td>
                                            <td style="text-align: left;"> {{ analise.amostra_detalhes?.numero }} </td>
                                            <td style="text-align: left;">
                                                {{ (analise.amostra_detalhes?.expressa_detalhes?.data || analise.amostra_detalhes?.ordem_detalhes?.data) | date:'dd/MM/yy' }}
                                            </td>
                                            <!-- <td style="text-align: left;"> {{ analise.amostra_detalhes?.expressa_detalhes?.classificacao || analise.amostra_detalhes?.ordem_detalhes?.classificacao }} </td> -->
                                            <td style="text-align: left;"> {{ analise.amostra_detalhes?.expressa_detalhes?.responsavel || analise.amostra_detalhes?.ordem_detalhes?.responsavel }} </td>
                                            <td style="text-align: left;">
                                                <p-tag
                                                    [value]="analise?.amostra_detalhes?.expressa_detalhes ? 'Expressa' : 'Plano'"
                                                    [severity]="analise?.amostra_detalhes?.expressa_detalhes ? getTipoOrdem('Expressa') : getTipoOrdem('normal')"
                                                />
                                            </td>
                                            <td style="text-align: left;">
                                                <p-tag
                                                    [value]="analise?.amostra_detalhes?.laboratorio || '-'"
                                                    [severity]="getLaboratorioSeverity(analise?.amostra_detalhes?.laboratorio)"
                                                />
                                            </td>
                                            <td style="text-align: center;">
                                                <div style="display: flex; justify-content: center;">

                                                    <p-speeddial 
                                                        showIcon="pi pi-bars" hideIcon="pi pi-times"
                                                        [model]="getMenuItems(analise)"
                                                        [radius]="80"
                                                        type="linear" 
                                                        direction="left"
                                                        [style]="{ position: 'relative', top: 0, right: 0 }" 
                                                        [buttonProps]="{ severity: 'info', rounded: true }"
                                                        [tooltipOptions]="{ tooltipPosition: 'bottom' }"
                                                        pTooltip="A√ß√µes"
                                                    ></p-speeddial>
                                                    <div 
                                                        style="position: relative;"
                                                        *ngIf="!analise.finalizada"
                                                    >
                                                        <a 
                                                            type="button" 
                                                            class="ml-2"
                                                            [routerLink]="['/welcome/controleQualidade/analise', analise.id]"
                                                        >
                                                            <p-button
                                                                severity="success" 
                                                                icon="pi pi-file-edit"
                                                                pTooltip="Realizar An√°lise"
                                                                tooltipPosition="top"
                                                                [disabled]="analise.finalizada" 
                                                                [rounded]="true" 
                                                            />
                                                        </a>
                                                    </div>
                                                    <div 
                                                        style="position: relative;"
                                                        *ngIf="!analise.finalizada"
                                                    >
                                                        <a 
                                                            type="button" 
                                                            class="ml-2"
                                                        >
                                                            <p-button 
                                                                icon="pi pi-lock"
                                                                severity="warn"
                                                                (onClick)="finalizarAnalise(analise)" 
                                                                [rounded]="true" 
                                                                [disabled]="analise.finalizada"
                                                                pTooltip="Finalizar OS"
                                                                tooltipPosition="top" 
                                                            />
                                                        </a>
                                                    </div>
                                                    <div 
                                                        style="position: relative;"
                                                        *ngIf="analise.finalizada"    
                                                    >
                                                        <a 
                                                            type="button" 
                                                            class="ml-2"  
                                                        >
                                                            <p-button 
                                                                icon="pi pi-lock-open"
                                                                severity="contrast"
                                                                (onClick)="reabrirAnalise(analise)" 
                                                                [rounded]="true" 
                                                                
                                                                pTooltip="Reabrir OS"
                                                                tooltipPosition="top" 
                                                            />
                                                        </a>
                                                    </div>
                                                    <div 
                                                        style="position: relative;"
                                                        *ngIf="analise.finalizada && !analise.laudo"
                                                    >
                                                        <p-button 
                                                            icon="pi pi-clipboard"
                                                            severity="warn"
                                                            (click)="laudoAnalise(analise, $event)" 
                                                            [rounded]="true" 
                                                            pTooltip="Encaminhar para Laudo"
                                                            tooltipPosition="top" 
                                                        />
                                                    </div>
                                                    <div 
                                                        style="position: relative;"
                                                        *ngIf="analise.finalizada && analise.laudo && !analise.aprovada"
                                                    >
                                                        <p-button 
                                                            icon="pi pi-check-circle"
                                                            severity="success"
                                                            (click)="aprovarAnalise(analise, $event)" 
                                                            [rounded]="true" 
                                                            [disabled]="aprovarAnaliseEmAndamento"
                                                            pTooltip="Aprovar OS"
                                                            tooltipPosition="top" 
                                                        />
                                                    </div>
                                                    <div 
                                                        style="position: relative;"
                                                        *ngIf="analise.finalizada && analise.laudo && analise.aprovada"
                                                    >
                                                        <p-button 
                                                            icon="pi pi-print"
                                                            severity="help"
                                                            [rounded]="true" 
                                                            pTooltip="Imprimir Laudo"
                                                            (click)="abrirModalLaudo(analise)"
                                                            tooltipPosition="top" 
                                                        />
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                            </div>
                        
                        </div>
                        
                    </p-card>
                </div>    
            </div>

        </div>

       
    </div>
    
</div>

    <!---------------------------------Modal Visualiza√ß√£o---------------------------------------------->
    <p-drawer 
        header="Visualizar OS" 
        [(visible)]="modalVisualizar" 
        position="left"
        styleClass="w-full md:w-10 lg:w-10 custom-drawer"
        [style]="{ height: '100vh' }"        
    >
        <div *ngIf="analiseSelecionada">
            <!-- Card de Dados -->
            <div class="mb-4">
                <div
                    class="shadow-2 hover:shadow-4 transition-duration-200 p-4"
                    style="border-radius: 12px; background-color: #4a4458;"
                >
                    <div class="flex align-items-center mb-3">
                        <i class="pi pi-info-circle mr-2" style="color: #e3d8ff; font-size: 1.5rem;"></i>
                        <h3 class="m-0" style="color: #e3d8ff;">Dados da OS</h3>
                    </div>
                    <div class="text-left" style="color: #e6defa;">
                        <p class="mb-2"><b>N√∫mero:</b> {{ analiseSelecionada.amostra_detalhes.numero }}</p>
                        <p class="mb-2"><b>Produto:</b> {{ analiseSelecionada.amostra_detalhes.produto_amostra_detalhes?.nome }}</p>
                        <p class="mb-2"><b>Classifica√ß√£o:</b> {{ analiseSelecionada.amostra_detalhes.expressa_detalhes?.classificacao || analiseSelecionada.amostra_detalhes.ordem_detalhes?.classificacao }}</p>
                        <p class="mb-2"><b>Respons√°vel:</b> {{ analiseSelecionada.amostra_detalhes.expressa_detalhes?.responsavel || analiseSelecionada.amostra_detalhes.ordem_detalhes?.responsavel }}</p>
                        <p class="mb-0"><b>Data de Abertura:</b> {{ (analiseSelecionada.amostra_detalhes.expressa_detalhes?.data || analiseSelecionada.amostra_detalhes.ordem_detalhes?.data) | date:'dd/MM/yyyy'}}</p>
                    </div>
                </div>
            </div>

            <!-- Cards de Ensaios Compostos -->
            <div *ngIf="analiseSelecionada?.ultimo_calculo?.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üß™ Ensaios Compostos</h3>
                <div class="grid">
                    <div class="col-12" *ngFor="let ultimo_calculo of analiseSelecionada.ultimo_calculo">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-4 mb-3"
                            style="border-radius: 12px; background-color: #2b3a55;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-flask mr-2" style="color: #b3e5ff; font-size: 1.3rem;"></i>
                                <h4 class="m-0" style="color: #d6f1ff;">{{ ultimo_calculo.calculos }}</h4>
                            </div>
                            <div class="mb-3 p-3" style="background-color: rgba(179, 229, 255, 0.1); border-radius: 8px;">
                                <p class="text-xl mb-0" style="color: #d6f1ff;"><b>Resultado:</b> <span style="font-size: 1.5rem; font-weight: 700;">{{ ultimo_calculo.resultados }}</span></p>
                            </div>
                            
                            <div *ngIf="ultimo_calculo.ensaios_utilizados?.length > 0">
                                <h5 class="mb-3" style="color: #b3e5ff;">Ensaios Utilizados</h5>
                                <div class="grid">
                                    <div class="col-12 md:col-6 lg:col-4" *ngFor="let ensaios_utilizados of ultimo_calculo.ensaios_utilizados">
                                        <div
                                            class="shadow-2 hover:shadow-3 transition-duration-200"
                                            style="height: 100px; border-radius: 10px; background-color: #1e2f45; position: relative; cursor: pointer;"
                                        >
                                            <i class="pi pi-check-circle" style="position: absolute; top: 8px; left: 8px; color: #b3e5ff; font-size: 1rem;"></i>
                                            <div
                                                style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #d6f1ff; font-size: 1.4rem; font-weight: 700; text-align: center;"
                                            >
                                                {{ ensaios_utilizados.valor }}
                                            </div>
                                            <div class="flex align-items-end h-full">
                                                <span class="p-2 text-xs font-semibold" style="color: #d6f1ff;">{{ ensaios_utilizados.descricao }}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cards de Ensaios Diretos -->
            <div *ngIf="analiseSelecionada?.ultimo_ensaio?.ensaios_utilizados?.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üî¨ Ensaios Diretos</h3>
                <div class="grid">
                    <div class="col-12 md:col-6 lg:col-4" *ngFor="let ensaios_utilizados of analiseSelecionada.ultimo_ensaio.ensaios_utilizados">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200"
                            style="height: 120px; border-radius: 12px; background-color: #26413c; position: relative; cursor: pointer;"
                        >
                            <i class="pi pi-chart-bar" style="position: absolute; top: 12px; left: 12px; color: #b2f5ea; font-size: 1.25rem;"></i>
                            <div
                                style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #ccfbf1; font-size: 1.8rem; font-weight: 700; text-align: center;"
                            >
                                {{ ensaios_utilizados.valor }}
                            </div>
                            <div class="flex align-items-end h-full">
                                <span class="p-3 text-sm font-semibold" style="color: #ccfbf1;">{{ ensaios_utilizados.descricao }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Cards de Varia√ß√£o Dimensional -->
            <div *ngIf="analiseSelecionada?.variacao_dimensional">
                <h3 class="mb-3" style="color: #e6defa;">üìê Varia√ß√£o Dimensional Linear</h3>
                <div class="grid">
                    
                    <!-- L0 - Medi√ß√µes Iniciais -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_dimensional.l0">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #4a4458; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-ruler" style="color: #e3d8ff; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #e3d8ff;">L0 - Inicial</h5>
                            </div>
                            <div style="color: #e6defa; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_dimensional.l0.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_dimensional.l0.cp1 }} mm</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_dimensional.l0.cp2 }} mm</p>
                                <p class="mb-0"><b>CP3:</b> {{ analiseSelecionada.variacao_dimensional.l0.cp3 }} mm</p>
                            </div>
                        </div>
                    </div>

                    <!-- L1 - 1 dia -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_dimensional.l1">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #2b3a55; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar" style="color: #b3e5ff; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b3e5ff;">L1 - 1 dia</h5>
                            </div>
                            <div style="color: #d6f1ff; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_dimensional.l1.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_dimensional.l1.cp1 }} mm</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_dimensional.l1.cp2 }} mm</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_dimensional.l1.cp3 }} mm</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(179, 229, 255, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #b3e5ff;">M√©dia: {{ analiseSelecionada.variacao_dimensional.l1.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #d6f1ff;">Desvio: {{ analiseSelecionada.variacao_dimensional.l1.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- L7 - 7 dias -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_dimensional.l7">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #26413c; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar-plus" style="color: #b2f5ea; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b2f5ea;">L7 - 7 dias</h5>
                            </div>
                            <div style="color: #ccfbf1; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_dimensional.l7.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_dimensional.l7.cp1 }} mm</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_dimensional.l7.cp2 }} mm</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_dimensional.l7.cp3 }} mm</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(178, 245, 234, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #b2f5ea;">M√©dia: {{ analiseSelecionada.variacao_dimensional.l7.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #ccfbf1;">Desvio: {{ analiseSelecionada.variacao_dimensional.l7.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- L28 - 28 dias -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_dimensional.l28">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #3b3b32; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar-times" style="color: #fff3b0; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #fff3b0;">L28 - 28 dias</h5>
                            </div>
                            <div style="color: #fff2a8; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_dimensional.l28.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_dimensional.l28.cp1 }} mm</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_dimensional.l28.cp2 }} mm</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_dimensional.l28.cp3 }} mm</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(255, 243, 176, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #fff3b0;">M√©dia: {{ analiseSelecionada.variacao_dimensional.l28.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #fff2a8;">Desvio: {{ analiseSelecionada.variacao_dimensional.l28.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Cards de Varia√ß√£o de Massa -->
            <div *ngIf="analiseSelecionada?.variacao_massa">
                <h3 class="mb-3" style="color: #e6defa;">‚öñÔ∏è Varia√ß√£o de Massa</h3>
                <div class="grid">
                    
                    <!-- M0 - Massa Inicial -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_massa.m0">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #4a4458; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-box" style="color: #e3d8ff; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #e3d8ff;">M0 - Inicial</h5>
                            </div>
                            <div style="color: #e6defa; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_massa.m0.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_massa.m0.cp1 }} g</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_massa.m0.cp2 }} g</p>
                                <p class="mb-0"><b>CP3:</b> {{ analiseSelecionada.variacao_massa.m0.cp3 }} g</p>
                            </div>
                        </div>
                    </div>

                    <!-- M1 - 1 dia -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_massa.m1">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #2b3a55; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar" style="color: #b3e5ff; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b3e5ff;">M1 - 1 dia</h5>
                            </div>
                            <div style="color: #d6f1ff; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_massa.m1.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_massa.m1.cp1 }} g</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_massa.m1.cp2 }} g</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_massa.m1.cp3 }} g</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(179, 229, 255, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #b3e5ff;">M√©dia: {{ analiseSelecionada.variacao_massa.m1.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #d6f1ff;">Desvio: {{ analiseSelecionada.variacao_massa.m1.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- M7 - 7 dias -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_massa.m7">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #26413c; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar-plus" style="color: #b2f5ea; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b2f5ea;">M7 - 7 dias</h5>
                            </div>
                            <div style="color: #ccfbf1; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_massa.m7.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_massa.m7.cp1 }} g</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_massa.m7.cp2 }} g</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_massa.m7.cp3 }} g</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(178, 245, 234, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #b2f5ea;">M√©dia: {{ analiseSelecionada.variacao_massa.m7.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #ccfbf1;">Desvio: {{ analiseSelecionada.variacao_massa.m7.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- M28 - 28 dias -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_massa.m28">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #3b3b32; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar-times" style="color: #fff3b0; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #fff3b0;">M28 - 28 dias</h5>
                            </div>
                            <div style="color: #fff2a8; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_massa.m28.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_massa.m28.cp1 }} g</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_massa.m28.cp2 }} g</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_massa.m28.cp3 }} g</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(255, 243, 176, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #fff3b0;">M√©dia: {{ analiseSelecionada.variacao_massa.m28.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #fff2a8;">Desvio: {{ analiseSelecionada.variacao_massa.m28.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Cards de M√≥dulo de Elasticidade -->
            <div *ngIf="analiseSelecionada?.modulo_elasticidade">
                <h3 class="mb-3" style="color: #e6defa;">üìä M√≥dulo de Elasticidade</h3>
                
                <!-- Card de M√©dia Geral -->
                <div class="mb-4" *ngIf="analiseSelecionada.modulo_elasticidade.media">
                    <div
                        class="shadow-2 hover:shadow-4 transition-duration-200 p-4"
                        style="border-radius: 12px; background-color: #4a4458;"
                    >
                        <div class="flex align-items-center justify-content-center">
                            <i class="pi pi-chart-line mr-3" style="color: #e3d8ff; font-size: 2rem;"></i>
                            <div class="text-center">
                                <p class="mb-1" style="color: #e6defa; font-size: 0.9rem;">M√≥dulo de Elasticidade M√©dio (Ed)</p>
                                <p class="mb-0" style="color: #e3d8ff; font-size: 2rem; font-weight: 700;">
                                    {{ analiseSelecionada.modulo_elasticidade.media.ed | number:'1.2-4' }} MPa
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cards dos Corpos de Prova -->
                <div class="grid">
                    
                    <!-- CP1 -->
                    <div class="col-12 md:col-6 lg:col-4" *ngIf="analiseSelecionada.modulo_elasticidade.cp1">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #2b3a55; min-height: 380px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-building" style="color: #b3e5ff; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b3e5ff;">CP1</h5>
                            </div>
                            <div style="color: #d6f1ff; font-size: 0.85rem;">
                                <!-- Resultado Principal -->
                                <div class="mb-3 p-2 text-center" style="background-color: rgba(179, 229, 255, 0.15); border-radius: 8px;">
                                    <p class="mb-1" style="color: #b3e5ff; font-size: 0.75rem;">Ed (MPa)</p>
                                    <p class="mb-0 font-bold" style="color: #b3e5ff; font-size: 1.3rem;">
                                        {{ analiseSelecionada.modulo_elasticidade.cp1.ed | number:'1.2-4' }}
                                    </p>
                                </div>
                                
                                <!-- Dimens√µes -->
                                <p class="mb-1"><b>Comprimento:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.comprimento }} mm</p>
                                <p class="mb-1"><b>Largura:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.largura }} mm</p>
                                <p class="mb-1"><b>Altura:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.altura }} mm</p>
                                <p class="mb-2"><b>Volume:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.volume | number:'1.2-2' }} mm¬≥</p>
                                
                                <!-- Massa e Carga -->
                                <p class="mb-1"><b>Massa:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.massa }} g</p>
                                <p class="mb-2"><b>P M√°x:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.pMax | number:'1.2-4' }} kN</p>
                                
                                <!-- Tempos -->
                                <p class="mb-1"><b>Tempo 1:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.tempo1 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 2:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.tempo2 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 3:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.tempo3 }} ¬µs</p>
                                <p class="mb-2"><b>Menor Tempo:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.menorTempo }} ¬µs</p>
                                
                                <!-- Velocidade -->
                                <p class="mb-0"><b>Velocidade:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.velocidade | number:'1.2-4' }} km/s</p>
                            </div>
                        </div>
                    </div>

                    <!-- CP2 -->
                    <div class="col-12 md:col-6 lg:col-4" *ngIf="analiseSelecionada.modulo_elasticidade.cp2">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #26413c; min-height: 380px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-building" style="color: #b2f5ea; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b2f5ea;">CP2</h5>
                            </div>
                            <div style="color: #ccfbf1; font-size: 0.85rem;">
                                <!-- Resultado Principal -->
                                <div class="mb-3 p-2 text-center" style="background-color: rgba(178, 245, 234, 0.15); border-radius: 8px;">
                                    <p class="mb-1" style="color: #b2f5ea; font-size: 0.75rem;">Ed (MPa)</p>
                                    <p class="mb-0 font-bold" style="color: #b2f5ea; font-size: 1.3rem;">
                                        {{ analiseSelecionada.modulo_elasticidade.cp2.ed | number:'1.2-4' }}
                                    </p>
                                </div>
                                
                                <!-- Dimens√µes -->
                                <p class="mb-1"><b>Comprimento:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.comprimento }} mm</p>
                                <p class="mb-1"><b>Largura:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.largura }} mm</p>
                                <p class="mb-1"><b>Altura:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.altura }} mm</p>
                                <p class="mb-2"><b>Volume:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.volume | number:'1.2-2' }} mm¬≥</p>
                                
                                <!-- Massa e Carga -->
                                <p class="mb-1"><b>Massa:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.massa }} g</p>
                                <p class="mb-2"><b>P M√°x:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.pMax | number:'1.2-4' }} kN</p>
                                
                                <!-- Tempos -->
                                <p class="mb-1"><b>Tempo 1:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.tempo1 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 2:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.tempo2 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 3:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.tempo3 }} ¬µs</p>
                                <p class="mb-2"><b>Menor Tempo:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.menorTempo }} ¬µs</p>
                                
                                <!-- Velocidade -->
                                <p class="mb-0"><b>Velocidade:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.velocidade | number:'1.2-4' }} km/s</p>
                            </div>
                        </div>
                    </div>

                    <!-- CP3 -->
                    <div class="col-12 md:col-6 lg:col-4" *ngIf="analiseSelecionada.modulo_elasticidade.cp3">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #3b3b32; min-height: 380px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-building" style="color: #fff3b0; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #fff3b0;">CP3</h5>
                            </div>
                            <div style="color: #fff2a8; font-size: 0.85rem;">
                                <!-- Resultado Principal -->
                                <div class="mb-3 p-2 text-center" style="background-color: rgba(255, 243, 176, 0.15); border-radius: 8px;">
                                    <p class="mb-1" style="color: #fff3b0; font-size: 0.75rem;">Ed (MPa)</p>
                                    <p class="mb-0 font-bold" style="color: #fff3b0; font-size: 1.3rem;">
                                        {{ analiseSelecionada.modulo_elasticidade.cp3.ed | number:'1.2-4' }}
                                    </p>
                                </div>
                                
                                <!-- Dimens√µes -->
                                <p class="mb-1"><b>Comprimento:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.comprimento }} mm</p>
                                <p class="mb-1"><b>Largura:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.largura }} mm</p>
                                <p class="mb-1"><b>Altura:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.altura }} mm</p>
                                <p class="mb-2"><b>Volume:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.volume | number:'1.2-2' }} mm¬≥</p>
                                
                                <!-- Massa e Carga -->
                                <p class="mb-1"><b>Massa:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.massa }} g</p>
                                <p class="mb-2"><b>P M√°x:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.pMax | number:'1.2-4' }} kN</p>
                                
                                <!-- Tempos -->
                                <p class="mb-1"><b>Tempo 1:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.tempo1 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 2:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.tempo2 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 3:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.tempo3 }} ¬µs</p>
                                <p class="mb-2"><b>Menor Tempo:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.menorTempo }} ¬µs</p>
                                
                                <!-- Velocidade -->
                                <p class="mb-0"><b>Velocidade:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.velocidade | number:'1.2-4' }} km/s</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Cards de Peneiras Secas -->
            <div *ngIf="analiseSelecionada?.peneiras?.peneiras && analiseSelecionada.peneiras.peneiras.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üî¨ Peneiras Secas</h3>
                
                <!-- Informa√ß√µes Gerais -->
                <div class="mb-4">
                    <div class="grid">
                        <div class="col-12 md:col-6">
                            <div
                                class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                                style="border-radius: 12px; background-color: #2b3a55;"
                            >
                                <div class="flex align-items-center justify-content-center">
                                    <i class="pi pi-box mr-2" style="color: #b3e5ff; font-size: 1.5rem;"></i>
                                    <div>
                                        <p class="mb-1" style="color: #d6f1ff; font-size: 0.8rem;">Massa da Amostra</p>
                                        <p class="mb-0" style="color: #b3e5ff; font-size: 1.5rem; font-weight: 700;">
                                            {{ analiseSelecionada.peneiras.amostra | number:'1.2-2' }} g
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 md:col-6">
                            <div
                                class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                                style="border-radius: 12px; background-color: #26413c;"
                            >
                                <div class="flex align-items-center justify-content-center">
                                    <i class="pi pi-filter mr-2" style="color: #b2f5ea; font-size: 1.5rem;"></i>
                                    <div>
                                        <p class="mb-1" style="color: #ccfbf1; font-size: 0.8rem;">Total de Finos</p>
                                        <p class="mb-0" style="color: #b2f5ea; font-size: 1.5rem; font-weight: 700;">
                                            {{ analiseSelecionada.peneiras.finos | number:'1.2-2' }} g
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Peneiras -->
                <div class="mb-3">
                    <div
                        class="shadow-2 p-3"
                        style="border-radius: 12px; background-color: #2b3a55; overflow-x: auto;"
                    >
                        <p-table [value]="analiseSelecionada.peneiras.peneiras" styleClass="p-datatable-sm">
                            <ng-template pTemplate="header">
                                <tr style="background-color: rgba(179, 229, 255, 0.1);">
                                    <th style="color: #b3e5ff;">Peneira</th>
                                    <th style="color: #b3e5ff;">Retido (g)</th>
                                    <th style="color: #b3e5ff;">Retido (%)</th>
                                    <th style="color: #b3e5ff;">Passante (%)</th>
                                    <th style="color: #b3e5ff;">Acumulado (%)</th>
                                    <th style="color: #b3e5ff;">Passante Acumulado (%)</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-linha>
                                <tr style="color: #d6f1ff;">
                                    <td><b>{{ linha.peneira }}</b></td>
                                    <td>{{ linha.valor_retido | number:'1.2-2' }}</td>
                                    <td>{{ linha.porcentual_retido | number:'1.2-2' }}</td>
                                    <td>{{ linha.passante | number:'1.2-2' }}</td>
                                    <td>{{ linha.acumulado | number:'1.2-2' }}</td>
                                    <td>{{ linha.passante_acumulado | number:'1.2-2' }}</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>

            <!-- Cards de Peneiras √ömidas -->
            <div *ngIf="analiseSelecionada?.peneiras_umidas?.peneiras && analiseSelecionada.peneiras_umidas.peneiras.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üíß Peneiras √ömidas</h3>
                
                <!-- Informa√ß√µes Gerais -->
                <div class="mb-4">
                    <div class="grid">
                        <div class="col-12 md:col-6">
                            <div
                                class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                                style="border-radius: 12px; background-color: #2b3a55;"
                            >
                                <div class="flex align-items-center justify-content-center">
                                    <i class="pi pi-box mr-2" style="color: #b3e5ff; font-size: 1.5rem;"></i>
                                    <div>
                                        <p class="mb-1" style="color: #d6f1ff; font-size: 0.8rem;">Massa da Amostra</p>
                                        <p class="mb-0" style="color: #b3e5ff; font-size: 1.5rem; font-weight: 700;">
                                            {{ analiseSelecionada.peneiras_umidas.amostra | number:'1.2-2' }} g
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 md:col-6">
                            <div
                                class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                                style="border-radius: 12px; background-color: #26413c;"
                            >
                                <div class="flex align-items-center justify-content-center">
                                    <i class="pi pi-filter mr-2" style="color: #b2f5ea; font-size: 1.5rem;"></i>
                                    <div>
                                        <p class="mb-1" style="color: #ccfbf1; font-size: 0.8rem;">Total de Finos</p>
                                        <p class="mb-0" style="color: #b2f5ea; font-size: 1.5rem; font-weight: 700;">
                                            {{ analiseSelecionada.peneiras_umidas.finos | number:'1.2-2' }} g
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Peneiras √ömidas -->
                <div class="mb-3">
                    <div
                        class="shadow-2 p-3"
                        style="border-radius: 12px; background-color: #26413c; overflow-x: auto;"
                    >
                        <p-table [value]="analiseSelecionada.peneiras_umidas.peneiras" styleClass="p-datatable-sm">
                            <ng-template pTemplate="header">
                                <tr style="background-color: rgba(178, 245, 234, 0.1);">
                                    <th style="color: #b2f5ea;">Peneira</th>
                                    <th style="color: #b2f5ea;">Retido (g)</th>
                                    <th style="color: #b2f5ea;">Retido (%)</th>
                                    <th style="color: #b2f5ea;">Passante (%)</th>
                                    <th style="color: #b2f5ea;">Acumulado (%)</th>
                                    <th style="color: #b2f5ea;">Passante Acumulado (%)</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-linha>
                                <tr style="color: #ccfbf1;">
                                    <td><b>{{ linha.peneira }}</b></td>
                                    <td>{{ linha.valor_retido | number:'1.2-2' }}</td>
                                    <td>{{ linha.porcentual_retido | number:'1.2-2' }}</td>
                                    <td>{{ linha.passante | number:'1.2-2' }}</td>
                                    <td>{{ linha.acumulado | number:'1.2-2' }}</td>
                                    <td>{{ linha.passante_acumulado | number:'1.2-2' }}</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>    

            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                <p-button 
                    label="Imprimir" 
                    (onClick)="imprimirVisualizar(analiseSelecionada)"
                    severity="success"
                    icon="pi pi-print" 
                    iconPos="right" 
                    tooltipPosition="top"
                    pTooltip="Gerar Impress√£o"
                />
            </div>

        </div>
    </p-drawer>

<!---------------------------------Modal Edi√ß√£o---------------------------------------------->

<p-drawer
    [(visible)]="editFormVisible"
    position="right"
    [style]="{ width: '60vw' }"
    styleClass="w-full md:w-12 lg:w-4"
>
        <div class="background-form">
            <form
                [formGroup]="editForm" title="Editar Tipo de Ensaio" class="flex flex-column gap-4" 
            >
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">

                        <p-card class="card w-12 text-center">
                            <ng-template #header>
                                <div class="header titulo-info w-full text-center">
                                    <b>Editar Ordem de Servi√ßo</b>
                                </div>
                            </ng-template>
                            <div class="bloco flex flex-column align-items-center w-12 gap-3">
                                <div class="w-11 text-left mt-3">
                                    <p-floatlabel variant="on">
                                        <p-iconfield>
                                            <p-inputicon class="pi pi-file-edit" />
                                            <input 
                                                variant="filled" [style]="{'width':'100%'}" 
                                                pInputText id="on_label"
                                                autocomplete="off" 
                                                formControlName="numero" 
                                                type="text" 
                                                readonly    
                                            />
                                        </p-iconfield>
                                        <label for="on_label">N√∫mero</label>
                                    </p-floatlabel>
                                </div>
                                <div class="w-11 text-left">
                                    <p-floatLabel variant="on">
                                        <p-select inputId="float-label" [style]="{'width':'100%'}"
                                            [options]="finalidades" formControlName="classificacao" optionLabel="nome"
                                            optionValue="nome" appendTo="body" [filter]="true" filterBy="nome"
                                            [showClear]="true">
                                        </p-select>
                                        <label for="float-label">Selecione a Classifica√ß√£o</label>
                                    </p-floatLabel>
                                </div>
                                <div class="w-11 text-left">
                                    <p-floatLabel variant="on">
                                        <p-select inputId="float-label" [style]="{'width':'100%'}"
                                            [options]="responsaveis" formControlName="responsavel" optionLabel="value"
                                            optionValue="value" appendTo="body" [filter]="true" filterBy="value"
                                            [showClear]="true">
                                        </p-select>
                                        <label for="float-label">Selecione o Respons√°vel</label>
                                    </p-floatLabel>
                                </div>
                                <div class="w-11 text-left mb-3">
                                    <p-floatLabel variant="on">
                                        <p-datepicker variant="filled" [style]="{'width':'100%'}" id="da"
                                            formControlName="data" dateFormat="dd/mm/yy" inputId="float-label"
                                            [showIcon]="true">
                                        </p-datepicker>
                                        <label for="float-label">Data de Abertura</label>
                                    </p-floatLabel>
                                </div>
                                <div class="w-11 text-left mb-3" *ngIf="editForm.get('plano_analise')?.value">
                                    <p-floatLabel variant="on">
                                        <p-select 
                                            inputId="float-label" 
                                            [style]="{'width':'100%'}"
                                            [options]="planosAnalise" 
                                            formControlName="plano_analise"
                                            optionLabel="descricao" 
                                            optionValue="id" 
                                        >
                                        </p-select>
                                        <label for="float-label">Selecione o Plano de An√°lise</label>
                                    </p-floatLabel>
                                </div>
                            </div>
                            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                                <p-button 
                                    label="Limpar"
                                    iconPos="right"  
                                    tooltipPosition="top"
                                    pTooltip="Limpar"
                                    icon="pi pi-eraser"
                                    severity="info"
                                    (onClick)="clearEditForm()" 
                                />
                                <p-button 
                                    label="Salvar" 
                                    severity="success"
                                    icon="pi pi-check" 
                                    iconPos="right" 
                                    tooltipPosition="top"
                                    pTooltip="Salvar"
                                    (onClick)="editForm.get('isExpressa')?.value ? saveEditExpressa(editForm.get('idSalvar')?.value) : saveEditOrdem(editForm.get('idSalvar')?.value)" 
                                />
                            </div>
                        </p-card>
                    </div>    
                </div>
            </form>
        </div>
</p-drawer>

<!-- Modal para sele√ß√£o de ensaios -->
<p-dialog header="Selecionar Ensaios" 
          [(visible)]="modalEnsaiosVisible" 
          [style]="{width: '80vw', height: '70vh'}" 
          [modal]="true" 
          [closable]="true"
          [draggable]="false" 
          [resizable]="false">
  
  <div class="flex flex-column h-full">
    <div class="flex-1 overflow-auto">
      <p-table [value]="ensaiosDisponiveis" 
               [scrollable]="true" 
               scrollHeight="400px"
               [paginator]="true" 
               [rows]="10"
               [globalFilterFields]="['descricao', 'tecnica', 'responsavel']">
        
        <ng-template pTemplate="header">
          <tr>
            <th style="width: 50px">
              <p-checkbox></p-checkbox>
            </th>
            <th>Descri√ß√£o</th>
            <th>T√©cnica</th>
            <th>Respons√°vel</th>
          </tr>
        </ng-template>
        
        <ng-template pTemplate="body" let-ensaio>
          <tr>
            <td>
              <p-checkbox [(ngModel)]="ensaio.selecionado" 
                          [binary]="true">
              </p-checkbox>
            </td>
            <td>{{ ensaio.descricao }}</td>
            <td>{{ ensaio.tecnica }}</td>
            <td>{{ ensaio.responsavel }}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
    
    <div class="flex justify-content-end gap-2 mt-3">
            <p-button 
                label="Cancelar" 
                severity="secondary" 
                (onClick)="fecharModalEnsaios()">
            </p-button>
            <p-button 
                label="Adicionar Selecionados" 
                icon="pi pi-plus" 
                (onClick)="adicionarEnsaiosSelecionados()">
            </p-button>
    </div>
  </div>
</p-dialog>

<p-dialog 
    [(visible)]="modalLaudo" 
    [modal]="true" 
    [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" 
    [style]="{ width: '80vw' }" 
    [draggable]="false" 
    [resizable]="false"
>
    <div class="containerInterno w-12">
        <div class="background-form">
           
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">

                        <p-card class="card w-12 text-center">
                            <ng-template #header>
                                <div class="header w-full text-center">
                                    <b>Selecionar √Ånalises do Laudo</b>
                                </div>
                            </ng-template>
                            <div class="flex flex-row w-12 gap-3">
                                <!-- Coluna da tabela -->
                                <div class="w-12">
                                    <p-table 
                                        [value]="ensaios_laudo" 
                                        [(selection)]="ensaios_selecionados" 
                                        dataKey="id"   
                                    >
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th style="width: 3em">
                                                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                            </th>
                                            <th>An√°lises</th>
                                            <th>Garantias</th>
                                        </tr>
                                    </ng-template>

                                    <ng-template pTemplate="body" let-ensaio>
                                        <tr [pSelectableRow]="ensaio">
                                        <td>
                                            <p-tableCheckbox [value]="ensaio"></p-tableCheckbox>
                                        </td>
                                            <td>{{ ensaio.descricao }}</td>
                                            <td>
                                                <input
                                                    value="{{ ensaio.garantia }}"
                                                    type="text"
                                                    pInputText
                                                    [(ngModel)]="ensaio.garantia"
                                                    placeholder="Digite a garantia"
                                                />
                                            </td>
                                        </tr>
                                    </ng-template>
                                    </p-table>
                                </div>
                            </div>
                            
                            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                                <p-button 
                                    label="Gerar Laudo" 
                                    (onClick)="salvarSelecionados()"
                                    severity="success"
                                    icon="pi pi-check" 
                                    iconPos="right" 
                                    tooltipPosition="top"
                                    pTooltip="Gerar Laudo"
                                />
                            </div>
                        </p-card>
                    </div>    
                </div>

        </div>
    </div>
</p-dialog>

<!-- Componentes necess√°rios para confirma√ß√µes e notifica√ß√µes -->
<p-confirmDialog></p-confirmDialog>
<p-toast position="top-left"></p-toast>
   


<!-- Modal para sele√ß√£o de ensaios PARA IMPRESS√ÉO -->
<p-dialog 
    [(visible)]="modalImpressao" 
    [modal]="true" 
    [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" 
    [style]="{ width: '80vw' }" 
    [draggable]="false" 
    [resizable]="false"
>
    <div class="containerInterno w-12">
        <div class="background-form">
           
            <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                <div class="fg1 flex flex-column w-12 align-items-center">

                    <p-card class="card w-12 text-center">
                        <ng-template #header>
                            <div class="header w-full text-center">
                                <b>Selecionar √Ånalises para Impress√£o</b>
                            </div>
                        </ng-template>
                        <div class="flex flex-row w-12 gap-3">
                            <!-- Coluna da tabela -->
                            <div class="w-12">
                                <p-table 
                                    [value]="ensaios_laudo" 
                                    [(selection)]="ensaios_selecionados" 
                                    dataKey="id"   
                                >
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th style="width: 3em">
                                                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                            </th>
                                            <th>An√°lises</th>
                                        </tr>
                                    </ng-template>

                                    <ng-template pTemplate="body" let-ensaio>
                                        <tr [pSelectableRow]="ensaio">
                                        <td>
                                            <p-tableCheckbox [value]="ensaio" [disabled]="ensaio.disabled"></p-tableCheckbox>
                                        </td>
                                            <td [style.color]="ensaio.color">{{ ensaio.descricao }}</td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                            </div>
                        </div>
                    
                        <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                            <p-button 
                                label="Gerar Impress√£o" 
                                (onClick)="imprimirSelecionados()"
                                severity="success"
                                icon="pi pi-check" 
                                iconPos="right" 
                                tooltipPosition="top"
                                pTooltip="Gerar Impress√£o"
                            />
                        </div>
                    </p-card>
                </div>    
            </div>
        </div>
    </div>
</p-dialog>


<!-- Modal para sele√ß√£o de ensaios PARA IMPRESS√ÉO -->

<p-dialog 
    [(visible)]="modalImpressao2" 
    [modal]="true" 
    [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" 
    [style]="{ width: '80vw' }" 
    [draggable]="false" 
    [resizable]="false"
>
    <div class="containerInterno w-12">
        <div class="background-form">
           
            <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                <div class="fg1 flex flex-column w-12 align-items-center">

                    <p-card class="card w-12 text-center">
                        <ng-template #header>
                            <div class="header w-full text-center">
                                <b>Selecionar An√°lises para Impress√£o</b>
                            </div>
                        </ng-template>
                        <div class="flex flex-row w-12 gap-3">
                            <!-- Coluna da tabela -->
                            <div class="w-12">
                                <p-treeTable
                                    [value]="ensaios_laudo"
                                    selectionMode="checkbox"
                                    [(selection)]="selectedEnsaios"
                                >

                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th>
                                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <p-checkbox
                                                binary="true"
                                                [indeterminate]="!isAllSelected() && selectedEnsaios.length > 0"
                                                [ngModel]="isAllSelected()"
                                                (onChange)="toggleSelectAll($event)"
                                            ></p-checkbox>
                                            <span class="ml-2">An√°lises</span>
                                            </th>
                                        </tr>
                                    </ng-template>

                                    <ng-template pTemplate="body" let-rowNode let-rowData="rowData">
                                        <tr>
                                            <td>
                                                <!-- üëá toggler fica em TODAS as linhas -->
                                                <p-treeTableToggler [rowNode]="rowNode"></p-treeTableToggler>
                                                <p-treeTableCheckbox [value]="rowNode"></p-treeTableCheckbox>

                                                {{ rowData?.descricao }}
                                            </td>
                                        </tr>
                                    </ng-template>
                                </p-treeTable>

                            </div>
                        </div>
                    
                        <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                            <p-button 
                                label="Gerar Impress√£o" 
                                (onClick)="imprimirSelecionados()"
                                severity="success"
                                icon="pi pi-check" 
                                iconPos="right" 
                                tooltipPosition="top"
                                pTooltip="Gerar Impress√£o"
                            />
                        </div>
                    </p-card>
                </div>    
            </div>
        </div>
    </div>
</p-dialog>

<p-drawer 
        header="Imagens da Amostra" 
        [(visible)]="modalImagensVisible" 
        position="right" 
        [style]="{ width: '80vw' }"
>
   <div class="class">     
        <div *ngIf="amostraImagensSelecionada" class="mb-4">
            <p>Amostra: {{ amostraImagensSelecionada.numero }}</p>
            <p><strong>Material:</strong> {{ amostraImagensSelecionada.material }}</p>
            <p><strong>Data de Coleta:</strong> {{ amostraImagensSelecionada.data_coleta | date:'dd/MM/yyyy' }}</p>
        </div>

        <div *ngIf="imagensAmostra.length > 0" class="image-viewer">
            <!-- Navega√ß√£o de imagens -->
            <div class="flex justify-content-between align-items-center mb-3">
            <p-button 
                icon="pi pi-chevron-left" 
                [disabled]="imagemAtualIndex === 0"
                (onClick)="imagemAnterior()"
                [rounded]="true">
            </p-button>
            
            <span class="text-lg font-semibold">
                {{ imagemAtualIndex + 1 }} de {{ imagensAmostra.length }}
            </span>
            
            <p-button 
                icon="pi pi-chevron-right" 
                [disabled]="imagemAtualIndex === imagensAmostra.length - 1"
                (onClick)="proximaImagem()"
                [rounded]="true">
            </p-button>
            </div>

            <!-- Imagem principal -->
            <div class="text-center mb-4">
            <img 
                [src]="imagensAmostra[imagemAtualIndex]?.image" 
                [alt]="imagensAmostra[imagemAtualIndex]?.descricao || 'Imagem da amostra'"
                style="max-width: 100%; max-height: 60vh; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            </div>

            <!-- Informa√ß√µes da imagem -->
            <div class="bg-gray-50 p-3 border-round mb-4">
            <p><strong>Descri√ß√£o:</strong> {{ imagensAmostra[imagemAtualIndex]?.descricao || 'Sem descri√ß√£o' }}</p>
            <p><strong>Data do Upload:</strong> {{ imagensAmostra[imagemAtualIndex]?.data_upload | date:'dd/MM/yyyy HH:mm' }}</p>
            <div class="bg-gray-50 p-3 border-round mb-4">
                <div class="w-full mb-3">
                    <p-floatLabel variant="on">
                        <input 
                            pInputText 
                            [(ngModel)]="imagensAmostra[imagemAtualIndex].descricao" 
                            type="text" 
                            id="edit-descricao"
                            [style]="{'width':'100%'}" 
                            autocomplete="off" 
                            variant="filled"
                            (ngModelChange)="onDescricaoChange(imagensAmostra[imagemAtualIndex])"
                        />
                        <label for="edit-descricao">Descri√ß√£o da imagem</label>
                    </p-floatLabel>
                </div>
                <p><strong>Data do Upload:</strong> {{ imagensAmostra[imagemAtualIndex]?.data_upload | date:'dd/MM/yyyy HH:mm' }}</p>
            </div>
            </div>

            <!-- A√ß√µes da imagem -->
            <div class="flex justify-content-center gap-2 mb-4">
            <p-button 
                label="Download" 
                icon="pi pi-download" 
                severity="info"
                (onClick)="downloadImagem(imagensAmostra[imagemAtualIndex])">
            </p-button>
            
            <p-button 
                label="Deletar" 
                icon="pi pi-trash" 
                severity="danger"
                (onClick)="deletarImagem(imagensAmostra[imagemAtualIndex].id)">
            </p-button>
            </div>

            <!-- Thumbnails (miniaturas) -->
            <div class="flex flex-wrap gap-2 justify-content-center" *ngIf="imagensAmostra.length > 1">
            <div 
                *ngFor="let imagem of imagensAmostra; let i = index"
                class="cursor-pointer border-2 border-round overflow-hidden"
                [class.border-primary]="i === imagemAtualIndex"
                [class.border-gray-300]="i !== imagemAtualIndex"
                (click)="irParaImagem(i)"
                style="width: 80px; height: 80px;">
                <img 
                [src]="imagem.image" 
                [alt]="'Miniatura ' + (i + 1)"
                style="width: 100%; height: 100%; object-fit: cover;">
            </div>
            </div>
        </div>

        <!-- Mensagem quando n√£o h√° imagens -->
        <div *ngIf="imagensAmostra.length === 0" class="text-center p-5">
            <i class="pi pi-images text-6xl text-gray-400 mb-3"></i>
            <p class="text-xl text-gray-600">Esta amostra n√£o possui imagens anexadas.</p>
        </div>
    </div>    
</p-drawer>