<div *ngIf="mostrarMenu" class="menu">
    <ul nz-menu nzMode="horizontal" style="overflow-x: auto; white-space: nowrap; background-color:#f2f2f2;height: 40px;box-shadow: 2px 0 6px ; ">
        <li nz-menu-item nzMatchRouter="#">
            <a style="font-size: 13px;" routerLink="/welcome/controleQualidade/dashControle">In√≠cio</a>
        </li>
        <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-submenu nzTitle="Cadastros "  style="font-size: 13px; ">
            <ul>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/tipoEnsaio">Tipo de Ensaio</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/variavel">Vari√°veis de Ensaio</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/ensaio" >Ensaio</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/calculoEnsaio" >C√°lculo de Ensaio</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/plano" >Plano de An√°lise</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/tipoAmostra" >Tipo de Amostra</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/produtoAmostra" >Produto de Amostra</a>
                </li>
                <li *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/controleQualidade/garantia" >Garantias</a>
                </li>
            </ul>
        </li >
        <li nz-menu-item nzMatchRouter="#" *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])">
            <a style="font-size: 13px;" routerLink="/welcome/controleQualidade/amostra">Amostras</a>
        </li>

        <li nz-menu-item nzMatchRouter="#" *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])">
            <a style="font-size: 13px;" routerLink="/welcome/controleQualidade/ordem">Ordens de Servi√ßo</a>
        </li>

        <li nz-menu-item nzMatchRouter="#" *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])">
            <a style="font-size: 13px;" routerLink="/welcome/controleQualidade/arquivo">Banco de An√°lises</a>
        </li>

        <li nz-menu-item nzMatchRouter="#" *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])">
            <a style="font-size: 13px;">Banco de Relat√≥rios</a>
        </li>
         <li nz-menu-item nzMatchRouter="#" *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])">
            <a style="font-size: 13px;" routerLink="/welcome/controleQualidade/resultados">Hist√≥rico de Resultados</a>
        </li>
        <li nz-menu-item nzMatchRouter="#" *ngIf="hasGroup(['Admin','Master','LabGestor','LabOp'])">
            <a style="font-size: 13px;" routerLink="/welcome/controleQualidade/acompanhamento">Acompanhamento de Tempo</a>
        </li>
    </ul>
</div>
    <div class="container flex flex-column align-items-center mb-4">
        <div class="containerInterno w-12">
            <div @swipeAnimation>
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">
                        <p-card class="card w-12 text-left">
                            <ng-template #header>
                                <div class="header titulo-info w-full text-center mb-0">
                                    <h2>Banco de An√°lises</h2>
                                </div>
                            </ng-template>
                            <p-table 
                                #dt1
                                sortField="id"
                                [sortOrder]="-1"
                                [value]="analisesFiltradas"
                                [paginator]="true"
                                [rows]="30"
                                [rowsPerPageOptions]="[10,20,30,50]"
                                [globalFilterFields]="[
                                    'fornecedor',
                                    'numero',
                                    'status',
                                    'responsavel',
                                    'laboratorio'
                                ]"
                            >
                            <ng-template pTemplate="caption">
                                <div class="step1 flex flex-column w-12 justify-content-between lg:w-12 lg:flex-row">
                                    <div class="flex gap-3 w-12">
                                        <div class="w-3 text-left">                                           
                                        </div>
                                        <div class="w-3 text-left">
                                        </div>
                                        <div class=" flex w-2 mt-3 justify-content-end text-right">
                                        </div>
                                        <div class=" flex w-2 mt-3 justify-content-end text-right">
                                        </div>
                                    </div>
                                    <div class=" flex w-2 gap-3 justify-content-end text-right">
                                        <p-floatlabel variant="on">
                                            <p-iconfield>
                                                <p-inputicon class="pi pi-search" style="color: #1b91ff;" />
                                                <input
                                                    variant="filled" 
                                                    [(ngModel)]="inputValue"
                                                    [style]="{'width':'100%'}" 
                                                    id="on_label"
                                                    class="form-control"
                                                    autocomplete="off" 
                                                    type="text"
                                                    pInputText id="on_label" 
                                                    (input)="filterTable()"
                                                />
                                            </p-iconfield>
                                            <label  for="on_label" style="color: #1b91ff">Pesquisar</label>
                                        </p-floatlabel>
                                    </div>
                                </div>
                                </ng-template>
                                <ng-template pTemplate="header">
                                    <tr class="tabela">
                                        <th style="width: 10%; text-align: left;">
                                            <p-multiselect
                                                [(ngModel)]="materiaisSelecionados"
                                                [options]="materiaisFiltro"
                                                (onChange)="filtrarPorMateriais()"
                                                placeholder="Material"
                                                [showClear]="true"
                                                optionLabel="label"
                                                optionValue="value"
                                                [maxSelectedLabels]="3"
                                                appendTo="body"
                                                size="small"
                                            >
                                                <ng-template pTemplate="selectedItems" let-selectedOptions>
                                                    <div class="flex gap-1 flex-wrap">
                                                        <p-tag
                                                            *ngFor="let option of selectedOptions"
                                                            [value]="option.value"
                                                            [severity]="getSeverity(option.value)"
                                                        />
                                                    </div>
                                                </ng-template>
                                                <ng-template pTemplate="item" let-option>
                                                    <p-tag [value]="option.value" [severity]="getSeverity(option.value)" />
                                                </ng-template>
                                            </p-multiselect>
                                        </th>
                                        <th 
                                            style="width: 15%; text-align: left;" 
                                            type="text"
                                            field="fornecedor" 
                                            display="menu"
                                        >N√∫mero</th>
                                        <th style="width: 10%; text-align: left;" type="text" field="laboratorio" display="menu">
                                            <p-multiselect
                                                [(ngModel)]="laboratoriosSelecionados"
                                                [options]="laboratoriosFiltro"
                                                (onChange)="filtrarPorLaboratorios()"
                                                placeholder="Laborat√≥rio"
                                                [showClear]="true"
                                                optionLabel="label"
                                                optionValue="value"
                                                [maxSelectedLabels]="2"
                                                appendTo="body"
                                                size="small"
                                            >
                                                <ng-template pTemplate="selectedItems" let-selectedOptions>
                                                    <div class="flex gap-1 flex-wrap">
                                                        <p-tag
                                                            *ngFor="let option of selectedOptions"
                                                            [value]="option.value"
                                                            [severity]="getLaboratorioSeverity(option.value)"
                                                        />
                                                    </div>
                                                </ng-template>
                                                <ng-template pTemplate="item" let-option>
                                                    <p-tag [value]="option.value" [severity]="getLaboratorioSeverity(option.value)" />
                                                </ng-template>
                                            </p-multiselect>
                                        </th>
                                        <th pSortableColumn="data_entrada" style="width: 10%;">
                                            <div class="flex justify-between items-left">
                                                Data de Abertura
                                                <p-sortIcon field="data_entrada" />
                                                <p-columnFilter 
                                                    type="date" 
                                                    field="data_entrada" 
                                                    display="menu"  
                                                    class="ml-auto" 
                                                    showMenu="false" 
                                                />
                                            </div>
                                        </th>
                                        <th style="width: 15%; text-align: left;" type="text" field="produto" display="menu">Produto</th>
                                        <th style="width: 10%; text-align: left;" type="text" field="responsavel" display="menu">Respons√°vel</th>
                                        <th style="width: 10%; text-align: left;" type="text" field="tipo" display="menu">
                                            <p-multiselect
                                                [(ngModel)]="tipoSelecionados"
                                                [options]="tipoFiltro"
                                                (onChange)="filtrarPorTipo()"
                                                placeholder="Tipo"
                                                [showClear]="true"
                                                optionLabel="label"
                                                optionValue="value"
                                                [maxSelectedLabels]="3"
                                                appendTo="body"
                                                size="small"
                                            >
                                                <ng-template pTemplate="selectedItems" let-selectedOptions>
                                                    <div class="flex gap-1 flex-wrap">
                                                        <p-tag
                                                            *ngFor="let option of selectedOptions"
                                                            [value]="option.value"
                                                            [severity]="getTipoOrdem(option.value)"
                                                        />
                                                    </div>
                                                </ng-template>
                                                <ng-template pTemplate="item" let-option>
                                                    <p-tag [value]="option.value" [severity]="getTipoOrdem(option.value)" />
                                                </ng-template>
                                            </p-multiselect>
                                        </th>
                                        <th style="width: 24%; text-align: center;" type="text" field="acoes"display="menu">Op√ß√µes</th>
                                        <th style="width: 2%; text-align: center;" type="text" field="laudo" display="menu">
                                            Laudo &nbsp;
                                            <p-columnFilter 
                                                type="boolean" 
                                                field="laudo"
                                                showMenu="false"
                                                default
                                                >   
                                            </p-columnFilter>
                                        </th>
                                        <th style="width: 2%; text-align: center;" type="text" field="aprovada" display="menu">
                                            Aprovada &nbsp;
                                            <p-columnFilter 
                                                type="boolean" 
                                                field="aprovada"
                                                showMenu="false"
                                                default
                                                >   
                                            </p-columnFilter>
                                        </th>
                                    
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-analise>
                                    <tr>
                                        <td style="text-align: left;">
                                            <p-tag
                                            [value]="analise.amostra_detalhes.material"
                                            [severity]="getSeverity(analise.amostra_detalhes.material)"
                                            />
                                        </td>
                                        <td style="text-align: left;"> {{ analise.amostra_detalhes?.numero }} </td>
                                        <td style="text-align: left;">
                                            <p-tag 
                                                *ngIf="analise?.amostra_detalhes?.laboratorio"
                                                [value]="analise.amostra_detalhes.laboratorio"
                                                [severity]="getLaboratorioSeverity(analise.amostra_detalhes.laboratorio)" />
                                        </td>
                                        <ng-container *ngIf="analise?.amostra_detalhes?.expressa_detalhes; else ensaioDetalhes">
                                            <td style="text-align: left;">
                                                {{ analise.amostra_detalhes?.expressa_detalhes?.data | date:'dd/MM/yy' }}
                                            </td>
                                            <td style="text-align: left;"> {{ analise.amostra_detalhes?.produto_amostra_detalhes.nome }} </td>
                                            <td style="text-align: left;"> {{ analise.amostra_detalhes.expressa_detalhes.responsavel }} </td>
                                            <td style="text-align: left;"> 
                                                <p-tag
                                                    [value]="'Expressa'"
                                                    [severity]="getTipoOrdem('Expressa')"
                                                />
                                            </td>
                                        </ng-container>
                                        <ng-template #ensaioDetalhes>
                                            <td style="text-align: left;">
                                                {{ analise.amostra_detalhes?.ordem_detalhes?.data | date:'dd/MM/yy' }}
                                            </td>
                                            <td style="text-align: left;"> {{ analise.amostra_detalhes?.produto_amostra_detalhes.nome }} </td>
                                            <td style="text-align: left;"> {{ analise.amostra_detalhes.ordem_detalhes.responsavel }} </td>
                                            <td style="text-align: left;">
                                                <p-tag
                                                    [value]="'Plano'"
                                                    [severity]="getTipoOrdem('normal')"
                                                />
                                            </td>
                                        </ng-template>
                                    
                                        <td style="text-align: center;">
                                            <div style="display: flex; justify-content: center;">

                                                <p-speeddial 
                                                    showIcon="pi pi-bars" hideIcon="pi pi-times"
                                                    [model]="getMenuItems(analise)"
                                                    [radius]="80"
                                                    type="linear" 
                                                    severity="info"
                                                    direction="left"
                                                    [style]="{ position: 'relative', top: 0, right: 0 }" 
                                                    [buttonProps]="{ severity: 'info', rounded: true }"
                                                    [tooltipOptions]="{ tooltipPosition: 'right' }"
                                                    pTooltip="A√ß√µes"
                                                ></p-speeddial>
                                                <div 
                                                    style="position: relative;"
                                                    *ngIf="!analise.finalizada"
                                                    class="ml-2"
                                                >
                                                    <p-button 
                                                        icon="pi pi-lock"
                                                        severity="primary"
                                                        (click)="finalizarAnalise(analise, $event)" 
                                                        [rounded]="true" 
                                                        [disabled]="analise.finalizada || finalizarAnaliseEmAndamento"
                                                        pTooltip="Finalizar OS"
                                                        tooltipPosition="top" 
                                                    />
                                                </div>
                                                <div 
                                                    style="position: relative;"
                                                    *ngIf="analise.finalizada && !analise.aprovada && !analise.laudo"    
                                                    class="ml-2"
                                                >
                                                        <p-button 
                                                            icon="pi pi-lock-open"
                                                            severity="contrast"
                                                            (click)="reabrirAnalise(analise, $event)" 
                                                            [rounded]="true" 
                                                            [disabled]="reabrirAnaliseEmAndamento"
                                                            pTooltip="Reabrir OS"
                                                            tooltipPosition="top"
                                                            [style.pointer-events]="reabrirAnaliseEmAndamento ? 'none' : 'auto'"
                                                        />
                                                </div>
                                                <div 
                                                    style="position: relative;"
                                                    *ngIf="analise.finalizada && analise.laudo"
                                                >
                                                    <a 
                                                        type="button" 
                                                        class="ml-2"
                                                    >
                                                        <p-button 
                                                            icon="pi pi-print"
                                                            severity="help"
                                                            [rounded]="true" 
                                                            pTooltip="Imprimir Laudo"
                                                            (onClick)="abrirModalLaudo(analise)"
                                                            tooltipPosition="top">
                                                        </p-button>
                                                    </a>
                                                </div>
                                                <div 
                                                    style="position: relative;"
                                                    *ngIf="analise.finalizada && !analise.laudo"
                                                    class="ml-2"
                                                >
                                                    <p-button 
                                                        icon="pi pi-check-circle"
                                                        severity="success"
                                                        (click)="aprovarAnalise(analise, $event)" 
                                                        [rounded]="true" 
                                                        [disabled]="aprovarAnaliseEmAndamento"
                                                        
                                                        pTooltip="Aprovar OS"
                                                        tooltipPosition="top" 
                                                    />
                
                                                </div>
                                                <div 
                                                    style="position: relative;"
                                                    *ngIf="analise.finalizada && !analise.laudo && analise.aprovada"
                                                    class="ml-2"
                                                >
                                                    <p-button 
                                                        icon="pi pi-clipboard"
                                                        severity="secondary"
                                                        (click)="laudoAnalise(analise, $event)" 
                                                        [rounded]="true" 
                                                        [disabled]="laudoAnaliseEmAndamento"
                                                        pTooltip="Encaminhar para Laudo"
                                                        tooltipPosition="top" 
                                                    />
                                                </div>
                                                <div
                                                    style="position: relative;"
                                                    class="ml-2"
                                                    *ngIf="analise.finalizada && !analise.laudo"
                                                >
                                                    <p-button 
                                                            icon="pi pi-file-check"
                                                            severity="warn"
                                                            [rounded]="true" 
                                                            pTooltip="Verificar Conformidade"
                                                            (onClick)="consultarParecer(analise)"
                                                            tooltipPosition="top">
                                                        </p-button>
                                                </div>
                                                <div 
                                                    style="position: relative;"
                                                    *ngIf="analise.finalizada && analise.laudo && analise.aprovada"
                                                    class="ml-2"
                                                >
                                                    <!-- <p-button 
                                                        *ngIf="analise.amostra_detalhes.material == 'Argamassa'; else outroBotao"
                                                        icon="pi pi-book"
                                                        severity="success"
                                                        [rounded]="true" 
                                                        pTooltip="Colocar dados Laudo"
                                                        (onClick)="abrirModalDadosLaudoSubstrato(analise)"
                                                        tooltipPosition="top">
                                                    </p-button> -->

                                                    <ng-template #outroBotao>
                                                        <p-button 
                                                            icon="pi pi-print"
                                                            severity="help"
                                                            [rounded]="true" 
                                                            pTooltip="Imprimir Laudo"
                                                            (onClick)="abrirModalLaudo(analise)"
                                                            tooltipPosition="top">
                                                        </p-button>
                                                    </ng-template>
                                                </div>
                                            </div>

                                        </td>
                                        <td style="text-align: center;">
                                            <i 
                                                class="pi ml-2" 
                                                [ngClass]="getStatusIcon(analise.laudo)"
                                                [style.color]="getStatusColor(analise.laudo)">
                                            </i>
                                        </td>
                                        <td style="text-align: center;">
                                            <i 
                                                class="pi" 
                                                [ngClass]="getStatusIcon(analise.aprovada)"
                                                [style.color]="getStatusColor(analise.aprovada)">
                                            </i>
                                        </td>             

                                    </tr>
                                </ng-template>
                            </p-table>
                        </p-card>
                    </div>
                </div>
            </div>
        </div>  

    <p-drawer 
        header="Imagens da Amostra" 
        [(visible)]="modalImagensVisible" 
        position="right" 
        [style]="{ width: '80vw' }">
        
        <div *ngIf="amostraImagensSelecionada" class="mb-4">
            <h3 style="color: #ffffff;">Amostra: {{ amostraImagensSelecionada.numero }}</h3>
            <p><strong>Material:</strong> {{ amostraImagensSelecionada.material }}</p>
            <p><strong>Data de Coleta:</strong> {{ amostraImagensSelecionada.data_coleta | date:'dd/MM/yyyy' }}</p>
        </div>

        <div *ngIf="imagensAmostra.length > 0" class="image-viewer">
            <!-- Navega√ß√£o de imagens -->
            <div class="flex justify-content-between align-items-center mb-3">
            <p-button 
                icon="pi pi-chevron-left" 
                [disabled]="imagemAtualIndex === 0"
                (onClick)="imagemAnterior()"
                [rounded]="true">
            </p-button>
            
            <span class="text-lg font-semibold">
                {{ imagemAtualIndex + 1 }} de {{ imagensAmostra.length }}
            </span>
            
            <p-button 
                icon="pi pi-chevron-right" 
                [disabled]="imagemAtualIndex === imagensAmostra.length - 1"
                (onClick)="proximaImagem()"
                [rounded]="true">
            </p-button>
            </div>

            <!-- Imagem principal -->
            <div class="text-center mb-4">
            <img 
                [src]="imagensAmostra[imagemAtualIndex]?.image" 
                [alt]="imagensAmostra[imagemAtualIndex]?.descricao || 'Imagem da amostra'"
                style="max-width: 100%; max-height: 60vh; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
            </div>

            <!-- Informa√ß√µes da imagem -->
            <div class="bg-gray-50 p-3 border-round mb-4">
            <p><strong>Descri√ß√£o:</strong> {{ imagensAmostra[imagemAtualIndex]?.descricao || 'Sem descri√ß√£o' }}</p>
            <p><strong>Data do Upload:</strong> {{ imagensAmostra[imagemAtualIndex]?.data_upload | date:'dd/MM/yyyy HH:mm' }}</p>
            <div class="bg-gray-50 p-3 border-round mb-4">
                <div class="w-full mb-3">
                    <p-floatLabel variant="on">
                        <input 
                            [(ngModel)]="imagensAmostra[imagemAtualIndex].descricao" 
                            type="text" 
                            id="edit-descricao"
                            [style]="{'width':'100%'}"
                            class="form-control" 
                            autocomplete="off" 
                            variant="filled"
                            (ngModelChange)="onDescricaoChange(imagensAmostra[imagemAtualIndex])"
                        />
                        <label for="edit-descricao">Descri√ß√£o da imagem</label>
                    </p-floatLabel>
                </div>
                <p><strong>Data do Upload:</strong> {{ imagensAmostra[imagemAtualIndex]?.data_upload | date:'dd/MM/yyyy HH:mm' }}</p>
            </div>
            </div>

            <!-- A√ß√µes da imagem -->
            <div class="flex justify-content-center gap-2 mb-4">
            <p-button 
                label="Download" 
                icon="pi pi-download" 
                severity="info"
                (onClick)="downloadImagem(imagensAmostra[imagemAtualIndex])">
            </p-button>
            
            <p-button 
                label="Deletar" 
                icon="pi pi-trash" 
                severity="danger"
                [disabled]="deletarImagemEmAndamento"
                (click)="deletarImagem(imagensAmostra[imagemAtualIndex].id, $event)">
            </p-button>
            </div>

            <!-- Thumbnails (miniaturas) -->
            <div class="flex flex-wrap gap-2 justify-content-center" *ngIf="imagensAmostra.length > 1">
            <div 
                *ngFor="let imagem of imagensAmostra; let i = index"
                class="cursor-pointer border-2 border-round overflow-hidden"
                [class.border-primary]="i === imagemAtualIndex"
                [class.border-gray-300]="i !== imagemAtualIndex"
                (click)="irParaImagem(i)"
                style="width: 80px; height: 80px;">
                <img 
                [src]="imagem.image" 
                [alt]="'Miniatura ' + (i + 1)"
                style="width: 100%; height: 100%; object-fit: cover;">
            </div>
            </div>
        </div>

        <!-- Mensagem quando n√£o h√° imagens -->
        <div *ngIf="imagensAmostra.length === 0" class="text-center p-5">
            <i class="pi pi-images text-6xl text-gray-400 mb-3"></i>
            <p class="text-xl text-gray-600">Esta amostra n√£o possui imagens anexadas.</p>
        </div>
    </p-drawer>

    <!-- Modal para sele√ß√£o de ensaios PARA IMPRESS√ÉO -->

    <p-dialog 
        [(visible)]="modalImpressao" 
        [modal]="true" 
        [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" 
        [style]="{ width: '80vw' }" 
        [draggable]="false" 
        [resizable]="false"
    >
        <div class="containerInterno w-12">
            <div class="background-form">
            
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">

                        <p-card class="card w-12 text-center">
                            <ng-template #header>
                                <div class="header w-full text-center">
                                    <b>Selecionar √Ånalises para Impress√£o</b>
                                </div>
                            </ng-template>
                            <div class="flex flex-row w-12 gap-3">
                                <!-- Coluna da tabela -->
                                <div class="w-12">
                                    <p-treeTable
                                        [value]="ensaios_laudo"
                                        selectionMode="checkbox"
                                        [(selection)]="selectedEnsaios"
                                    >

                                        <ng-template pTemplate="header">
                                            <tr>
                                            <th>Descri√ß√£o</th>
                                            </tr>
                                        </ng-template>

                                        <ng-template pTemplate="body" let-rowNode let-rowData="rowData">
                                            <tr>
                                            <td>
                                                <!-- üëá toggler fica em TODAS as linhas -->
                                                <p-treeTableToggler [rowNode]="rowNode"></p-treeTableToggler>
                                                <p-treeTableCheckbox [value]="rowNode"></p-treeTableCheckbox>

                                                {{ rowData?.descricao }}</td>
                                            </tr>
                                        </ng-template>
                                    </p-treeTable>

                                </div>
                            </div>
                        
                            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                                <p-button 
                                    label="Gerar Impress√£o" 
                                    (onClick)="imprimirSelecionados()"
                                    severity="success"
                                    icon="pi pi-check" 
                                    iconPos="right" 
                                    tooltipPosition="top"
                                    pTooltip="Gerar Impress√£o"
                                />
                            </div>
                        </p-card>
                    </div>    
                </div>
            </div>
        </div>
    </p-dialog>

    <!---------------------------------Modal Visualiza√ß√£o---------------------------------------------->
    <p-drawer 
        header="Visualizar OS" 
        [(visible)]="modalVisualizar" 
        position="left"
        styleClass="w-full md:w-10 lg:w-10 custom-drawer"
        [style]="{ height: '100vh' }"        
    >
        <div *ngIf="analiseSelecionada">
            <!-- Card de Dados -->
            <div class="mb-4">
                <div
                    class="shadow-2 hover:shadow-4 transition-duration-200 p-4"
                    style="border-radius: 12px; background-color: #4a4458;"
                >
                    <div class="flex align-items-center mb-3">
                        <i class="pi pi-info-circle mr-2" style="color: #e3d8ff; font-size: 1.5rem;"></i>
                        <h3 class="m-0" style="color: #e3d8ff;">Dados da OS</h3>
                    </div>
                    <div class="text-left" style="color: #e6defa;">
                        <p class="mb-2"><b>N√∫mero:</b> {{ analiseSelecionada.amostra_detalhes.numero }}</p>
                        <p class="mb-2"><b>Produto:</b> {{ analiseSelecionada.amostra_detalhes.produto_amostra_detalhes?.nome }}</p>
                        <p class="mb-2"><b>Classifica√ß√£o:</b> {{ analiseSelecionada.amostra_detalhes.expressa_detalhes?.classificacao || analiseSelecionada.amostra_detalhes.ordem_detalhes?.classificacao }}</p>
                        <p class="mb-2"><b>Respons√°vel:</b> {{ analiseSelecionada.amostra_detalhes.expressa_detalhes?.responsavel || analiseSelecionada.amostra_detalhes.ordem_detalhes?.responsavel }}</p>
                        <p class="mb-0"><b>Data de Abertura:</b> {{ (analiseSelecionada.amostra_detalhes.expressa_detalhes?.data || analiseSelecionada.amostra_detalhes.ordem_detalhes?.data) | date:'dd/MM/yyyy'}}</p>
                        <p *ngIf="analiseSelecionada.material_organico" class="mb-0"><b>Material Org√¢nico:</b> {{ analiseSelecionada.material_organico }}</p>
                    </div>
                </div>
            </div>

            <!-- Cards de Ensaios Compostos -->
            <div *ngIf="analiseSelecionada?.ultimo_calculo?.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üß™ Ensaios Compostos</h3>
                <div class="grid">
                    <div class="col-12" *ngFor="let ultimo_calculo of analiseSelecionada.ultimo_calculo">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-4 mb-3"
                            style="border-radius: 12px; background-color: #2b3a55;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-flask mr-2" style="color: #b3e5ff; font-size: 1.3rem;"></i>
                                <h4 class="m-0" style="color: #d6f1ff;">{{ ultimo_calculo.calculos }}</h4>
                            </div>
                            <div class="mb-3 p-3" style="background-color: rgba(179, 229, 255, 0.1); border-radius: 8px;">
                                <p class="text-xl mb-0" style="color: #d6f1ff;"><b>Resultado:</b> <span style="font-size: 1.5rem; font-weight: 700;">
                                    {{ calcResultadoEhData(ultimo_calculo) ? 
                                        converterResultadoCalculoParaData(ultimo_calculo) : 
                                        (typeof ultimo_calculo.resultados === 'number' ? 
                                            formatForDisplay(ultimo_calculo.resultados) : 
                                            ultimo_calculo.resultados) 
                                    }}
                                </span></p>
                            </div>
                            
                            <div *ngIf="ultimo_calculo.ensaios_utilizados?.length > 0">
                                <h5 class="mb-3" style="color: #b3e5ff;">Ensaios Utilizados</h5>
                                <div class="grid">
                                    <div class="col-12 md:col-6 lg:col-4" *ngFor="let ensaios_utilizados of ultimo_calculo.ensaios_utilizados">
                                        <div
                                            class="shadow-2 hover:shadow-3 transition-duration-200"
                                            style="height: 100px; border-radius: 10px; background-color: #1e2f45; position: relative; cursor: pointer;"
                                        >
                                            <i class="pi pi-check-circle" style="position: absolute; top: 8px; left: 8px; color: #b3e5ff; font-size: 1rem;"></i>
                                            <div
                                                style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #d6f1ff; font-size: 1.4rem; font-weight: 700; text-align: center;"
                                            >
                                                {{ ensaios_utilizados.tipo_ensaio === 'data' ? 
                                                    converterResultadoParaData(ensaios_utilizados.valor) : 
                                                    (typeof ensaios_utilizados.valor === 'number' ? 
                                                        formatForDisplay(ensaios_utilizados.valor) : 
                                                        (ensaios_utilizados.valor || 0)) 
                                                }}
                                            </div>
                                            <div class="flex align-items-end h-full">
                                                <span class="p-2 text-xs font-semibold" style="color: #d6f1ff;">{{ ensaios_utilizados.descricao }}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cards de Ensaios Diretos -->
            <div *ngIf="analiseSelecionada?.ultimo_ensaio?.ensaios_utilizados?.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üî¨ Ensaios Diretos</h3>
                <div class="grid">
                    <div class="col-12 md:col-6 lg:col-4" *ngFor="let ensaios_utilizados of analiseSelecionada.ultimo_ensaio.ensaios_utilizados">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200"
                            style="height: 120px; border-radius: 12px; background-color: #26413c; position: relative; cursor: pointer;"
                        >
                            <i class="pi pi-chart-bar" style="position: absolute; top: 12px; left: 12px; color: #b2f5ea; font-size: 1.25rem;"></i>
                            <div
                                style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #ccfbf1; font-size: 1.8rem; font-weight: 700; text-align: center;"
                            >
                                {{ ensaios_utilizados.tipo_ensaio === 'data' ? 
                                    converterResultadoParaData(ensaios_utilizados.valor) : 
                                    (typeof ensaios_utilizados.valor === 'number' ? 
                                        formatForDisplay(ensaios_utilizados.valor) : 
                                        (ensaios_utilizados.valor || 0)) 
                                }}
                            </div>
                            <div class="flex align-items-end h-full">
                                <span class="p-3 text-sm font-semibold" style="color: #ccfbf1;">{{ ensaios_utilizados.descricao }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Cards de Varia√ß√£o Dimensional -->
            <div *ngIf="analiseSelecionada?.variacao_dimensional">
                <h3 class="mb-3" style="color: #e6defa;">üìê Varia√ß√£o Dimensional Linear</h3>
                <div class="grid">
                    
                    <!-- L0 - Medi√ß√µes Iniciais -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_dimensional.l0">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #4a4458; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-ruler" style="color: #e3d8ff; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #e3d8ff;">L0 - Inicial</h5>
                            </div>
                            <div style="color: #e6defa; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_dimensional.l0.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_dimensional.l0.cp1 }} mm</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_dimensional.l0.cp2 }} mm</p>
                                <p class="mb-0"><b>CP3:</b> {{ analiseSelecionada.variacao_dimensional.l0.cp3 }} mm</p>
                            </div>
                        </div>
                    </div>

                    <!-- L1 - 1 dia -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_dimensional.l1">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #2b3a55; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar" style="color: #b3e5ff; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b3e5ff;">L1 - 1 dia</h5>
                            </div>
                            <!-- Aviso de Status -->
                            <div class="mb-2 p-2 text-center" 
                                 [style.background-color]="getStatusL1(analiseSelecionada.variacao_dimensional.l0?.data).cor + '20'"
                                 style="border-radius: 8px; border-left: 4px solid"
                                 [style.border-color]="getStatusL1(analiseSelecionada.variacao_dimensional.l0?.data).cor">
                                <i class="pi" [ngClass]="getStatusL1(analiseSelecionada.variacao_dimensional.l0?.data).icone" 
                                   [style.color]="getStatusL1(analiseSelecionada.variacao_dimensional.l0?.data).cor"></i>
                                <span class="ml-2 font-bold" 
                                      [style.color]="getStatusL1(analiseSelecionada.variacao_dimensional.l0?.data).cor"
                                      style="font-size: 0.85rem;">
                                    {{ getStatusL1(analiseSelecionada.variacao_dimensional.l0?.data).status }}
                                </span>
                            </div>
                            <div style="color: #d6f1ff; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_dimensional.l1.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_dimensional.l1.cp1 }} mm</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_dimensional.l1.cp2 }} mm</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_dimensional.l1.cp3 }} mm</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(179, 229, 255, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #b3e5ff;">M√©dia: {{ analiseSelecionada.variacao_dimensional.l1.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #d6f1ff;">Desvio: {{ analiseSelecionada.variacao_dimensional.l1.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- L7 - 7 dias -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_dimensional.l7">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #26413c; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar-plus" style="color: #b2f5ea; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b2f5ea;">L7 - 7 dias</h5>
                            </div>
                            <!-- Aviso de Status -->
                            <div class="mb-2 p-2 text-center" 
                                 [style.background-color]="getStatusL7(analiseSelecionada.variacao_dimensional.l0?.data).cor + '20'"
                                 style="border-radius: 8px; border-left: 4px solid"
                                 [style.border-color]="getStatusL7(analiseSelecionada.variacao_dimensional.l0?.data).cor">
                                <i class="pi" [ngClass]="getStatusL7(analiseSelecionada.variacao_dimensional.l0?.data).icone" 
                                   [style.color]="getStatusL7(analiseSelecionada.variacao_dimensional.l0?.data).cor"></i>
                                <span class="ml-2 font-bold" 
                                      [style.color]="getStatusL7(analiseSelecionada.variacao_dimensional.l0?.data).cor"
                                      style="font-size: 0.85rem;">
                                    {{ getStatusL7(analiseSelecionada.variacao_dimensional.l0?.data).status }}
                                </span>
                            </div>
                            <div style="color: #ccfbf1; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_dimensional.l7.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_dimensional.l7.cp1 }} mm</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_dimensional.l7.cp2 }} mm</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_dimensional.l7.cp3 }} mm</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(178, 245, 234, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #b2f5ea;">M√©dia: {{ analiseSelecionada.variacao_dimensional.l7.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #ccfbf1;">Desvio: {{ analiseSelecionada.variacao_dimensional.l7.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- L28 - 28 dias -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_dimensional.l28">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #3b3b32; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar-times" style="color: #fff3b0; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #fff3b0;">L28 - 28 dias</h5>
                            </div>
                            <!-- Aviso de Status -->
                            <div class="mb-2 p-2 text-center" 
                                 [style.background-color]="getStatusL28(analiseSelecionada.variacao_dimensional.l0?.data).cor + '20'"
                                 style="border-radius: 8px; border-left: 4px solid"
                                 [style.border-color]="getStatusL28(analiseSelecionada.variacao_dimensional.l0?.data).cor">
                                <i class="pi" [ngClass]="getStatusL28(analiseSelecionada.variacao_dimensional.l0?.data).icone" 
                                   [style.color]="getStatusL28(analiseSelecionada.variacao_dimensional.l0?.data).cor"></i>
                                <span class="ml-2 font-bold" 
                                      [style.color]="getStatusL28(analiseSelecionada.variacao_dimensional.l0?.data).cor"
                                      style="font-size: 0.85rem;">
                                    {{ getStatusL28(analiseSelecionada.variacao_dimensional.l0?.data).status }}
                                </span>
                            </div>
                            <div style="color: #fff2a8; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_dimensional.l28.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_dimensional.l28.cp1 }} mm</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_dimensional.l28.cp2 }} mm</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_dimensional.l28.cp3 }} mm</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(255, 243, 176, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #fff3b0;">M√©dia: {{ analiseSelecionada.variacao_dimensional.l28.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #fff2a8;">Desvio: {{ analiseSelecionada.variacao_dimensional.l28.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Cards de Varia√ß√£o de Massa -->
            <div *ngIf="analiseSelecionada?.variacao_massa">
                <h3 class="mb-3" style="color: #e6defa;">‚öñÔ∏è Varia√ß√£o de Massa</h3>
                <div class="grid">
                    
                    <!-- M0 - Massa Inicial -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_massa.m0">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #4a4458; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-box" style="color: #e3d8ff; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #e3d8ff;">M0 - Inicial</h5>
                            </div>
                            <div style="color: #e6defa; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_massa.m0.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_massa.m0.cp1 }} g</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_massa.m0.cp2 }} g</p>
                                <p class="mb-0"><b>CP3:</b> {{ analiseSelecionada.variacao_massa.m0.cp3 }} g</p>
                            </div>
                        </div>
                    </div>

                    <!-- M1 - 1 dia -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_massa.m1">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #2b3a55; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar" style="color: #b3e5ff; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b3e5ff;">M1 - 1 dia</h5>
                            </div>
                            <!-- Aviso de Status -->
                            <div class="mb-2 p-2 text-center" 
                                 [style.background-color]="getStatusM1(analiseSelecionada.variacao_massa.m0?.data).cor + '20'"
                                 style="border-radius: 8px; border-left: 4px solid"
                                 [style.border-color]="getStatusM1(analiseSelecionada.variacao_massa.m0?.data).cor">
                                <i class="pi" [ngClass]="getStatusM1(analiseSelecionada.variacao_massa.m0?.data).icone" 
                                   [style.color]="getStatusM1(analiseSelecionada.variacao_massa.m0?.data).cor"></i>
                                <span class="ml-2 font-bold" 
                                      [style.color]="getStatusM1(analiseSelecionada.variacao_massa.m0?.data).cor"
                                      style="font-size: 0.85rem;">
                                    {{ getStatusM1(analiseSelecionada.variacao_massa.m0?.data).status }}
                                </span>
                            </div>
                            <div style="color: #d6f1ff; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_massa.m1.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_massa.m1.cp1 }} g</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_massa.m1.cp2 }} g</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_massa.m1.cp3 }} g</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(179, 229, 255, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #b3e5ff;">M√©dia: {{ analiseSelecionada.variacao_massa.m1.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #d6f1ff;">Desvio: {{ analiseSelecionada.variacao_massa.m1.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- M7 - 7 dias -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_massa.m7">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #26413c; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar-plus" style="color: #b2f5ea; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b2f5ea;">M7 - 7 dias</h5>
                            </div>
                            <!-- Aviso de Status -->
                            <div class="mb-2 p-2 text-center" 
                                 [style.background-color]="getStatusM7(analiseSelecionada.variacao_massa.m0?.data).cor + '20'"
                                 style="border-radius: 8px; border-left: 4px solid"
                                 [style.border-color]="getStatusM7(analiseSelecionada.variacao_massa.m0?.data).cor">
                                <i class="pi" [ngClass]="getStatusM7(analiseSelecionada.variacao_massa.m0?.data).icone" 
                                   [style.color]="getStatusM7(analiseSelecionada.variacao_massa.m0?.data).cor"></i>
                                <span class="ml-2 font-bold" 
                                      [style.color]="getStatusM7(analiseSelecionada.variacao_massa.m0?.data).cor"
                                      style="font-size: 0.85rem;">
                                    {{ getStatusM7(analiseSelecionada.variacao_massa.m0?.data).status }}
                                </span>
                            </div>
                            <div style="color: #ccfbf1; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_massa.m7.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_massa.m7.cp1 }} g</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_massa.m7.cp2 }} g</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_massa.m7.cp3 }} g</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(178, 245, 234, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #b2f5ea;">M√©dia: {{ analiseSelecionada.variacao_massa.m7.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #ccfbf1;">Desvio: {{ analiseSelecionada.variacao_massa.m7.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- M28 - 28 dias -->
                    <div class="col-12 md:col-6 lg:col-3" *ngIf="analiseSelecionada.variacao_massa.m28">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #3b3b32; min-height: 200px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-calendar-times" style="color: #fff3b0; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #fff3b0;">M28 - 28 dias</h5>
                            </div>
                            <!-- Aviso de Status -->
                            <div class="mb-2 p-2 text-center" 
                                 [style.background-color]="getStatusM28(analiseSelecionada.variacao_massa.m0?.data).cor + '20'"
                                 style="border-radius: 8px; border-left: 4px solid"
                                 [style.border-color]="getStatusM28(analiseSelecionada.variacao_massa.m0?.data).cor">
                                <i class="pi" [ngClass]="getStatusM28(analiseSelecionada.variacao_massa.m0?.data).icone" 
                                   [style.color]="getStatusM28(analiseSelecionada.variacao_massa.m0?.data).cor"></i>
                                <span class="ml-2 font-bold" 
                                      [style.color]="getStatusM28(analiseSelecionada.variacao_massa.m0?.data).cor"
                                      style="font-size: 0.85rem;">
                                    {{ getStatusM28(analiseSelecionada.variacao_massa.m0?.data).status }}
                                </span>
                            </div>
                            <div style="color: #fff2a8; font-size: 0.9rem;">
                                <p class="mb-2"><b>Data:</b> {{ analiseSelecionada.variacao_massa.m28.data | date:'dd/MM/yyyy' }}</p>
                                <p class="mb-1"><b>CP1:</b> {{ analiseSelecionada.variacao_massa.m28.cp1 }} g</p>
                                <p class="mb-1"><b>CP2:</b> {{ analiseSelecionada.variacao_massa.m28.cp2 }} g</p>
                                <p class="mb-2"><b>CP3:</b> {{ analiseSelecionada.variacao_massa.m28.cp3 }} g</p>
                                <div class="mt-2 p-2 text-center" style="background-color: rgba(255, 243, 176, 0.15); border-radius: 8px;">
                                    <p class="font-bold mb-1" style="color: #fff3b0;">M√©dia: {{ analiseSelecionada.variacao_massa.m28.media | number:'1.2-4' }} %</p>
                                    <p class="text-xs mb-0" style="color: #fff2a8;">Desvio: {{ analiseSelecionada.variacao_massa.m28.desvio_padrao | number:'1.2-4' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Cards de M√≥dulo de Elasticidade -->
            <div *ngIf="analiseSelecionada?.modulo_elasticidade">
                <h3 class="mb-3" style="color: #e6defa;">üìä M√≥dulo de Elasticidade</h3>
                
                <!-- Card de M√©dia Geral -->
                <div class="mb-4" *ngIf="analiseSelecionada.modulo_elasticidade.media">
                    <div
                        class="shadow-2 hover:shadow-4 transition-duration-200 p-4"
                        style="border-radius: 12px; background-color: #4a4458;"
                    >
                        <div class="flex align-items-center justify-content-center">
                            <i class="pi pi-chart-line mr-3" style="color: #e3d8ff; font-size: 2rem;"></i>
                            <div class="text-center">
                                <p class="mb-1" style="color: #e6defa; font-size: 0.9rem;">M√≥dulo de Elasticidade M√©dio (Ed)</p>
                                <p class="mb-0" style="color: #e3d8ff; font-size: 2rem; font-weight: 700;">
                                    {{ analiseSelecionada.modulo_elasticidade.media.ed | number:'1.2-4' }} MPa
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cards dos Corpos de Prova -->
                <div class="grid">
                    
                    <!-- CP1 -->
                    <div class="col-12 md:col-6 lg:col-4" *ngIf="analiseSelecionada.modulo_elasticidade.cp1">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #2b3a55; min-height: 380px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-building" style="color: #b3e5ff; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b3e5ff;">CP1</h5>
                            </div>
                            <div style="color: #d6f1ff; font-size: 0.85rem;">
                                <!-- Resultado Principal -->
                                <div class="mb-3 p-2 text-center" style="background-color: rgba(179, 229, 255, 0.15); border-radius: 8px;">
                                    <p class="mb-1" style="color: #b3e5ff; font-size: 0.75rem;">Ed (MPa)</p>
                                    <p class="mb-0 font-bold" style="color: #b3e5ff; font-size: 1.3rem;">
                                        {{ analiseSelecionada.modulo_elasticidade.cp1.ed | number:'1.2-4' }}
                                    </p>
                                </div>
                                
                                <!-- Dimens√µes -->
                                <p class="mb-1"><b>Comprimento:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.comprimento }} mm</p>
                                <p class="mb-1"><b>Largura:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.largura }} mm</p>
                                <p class="mb-1"><b>Altura:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.altura }} mm</p>
                                <p class="mb-2"><b>Volume:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.volume | number:'1.2-2' }} mm¬≥</p>
                                
                                <!-- Massa e Carga -->
                                <p class="mb-1"><b>Massa:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.massa }} g</p>
                                <p class="mb-2"><b>P M√°x:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.pMax | number:'1.2-4' }} kN</p>
                                
                                <!-- Tempos -->
                                <p class="mb-1"><b>Tempo 1:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.tempo1 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 2:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.tempo2 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 3:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.tempo3 }} ¬µs</p>
                                <p class="mb-2"><b>Menor Tempo:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.menorTempo }} ¬µs</p>
                                
                                <!-- Velocidade -->
                                <p class="mb-0"><b>Velocidade:</b> {{ analiseSelecionada.modulo_elasticidade.cp1.velocidade | number:'1.2-4' }} km/s</p>
                            </div>
                        </div>
                    </div>

                    <!-- CP2 -->
                    <div class="col-12 md:col-6 lg:col-4" *ngIf="analiseSelecionada.modulo_elasticidade.cp2">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #26413c; min-height: 380px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-building" style="color: #b2f5ea; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #b2f5ea;">CP2</h5>
                            </div>
                            <div style="color: #ccfbf1; font-size: 0.85rem;">
                                <!-- Resultado Principal -->
                                <div class="mb-3 p-2 text-center" style="background-color: rgba(178, 245, 234, 0.15); border-radius: 8px;">
                                    <p class="mb-1" style="color: #b2f5ea; font-size: 0.75rem;">Ed (MPa)</p>
                                    <p class="mb-0 font-bold" style="color: #b2f5ea; font-size: 1.3rem;">
                                        {{ analiseSelecionada.modulo_elasticidade.cp2.ed | number:'1.2-4' }}
                                    </p>
                                </div>
                                
                                <!-- Dimens√µes -->
                                <p class="mb-1"><b>Comprimento:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.comprimento }} mm</p>
                                <p class="mb-1"><b>Largura:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.largura }} mm</p>
                                <p class="mb-1"><b>Altura:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.altura }} mm</p>
                                <p class="mb-2"><b>Volume:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.volume | number:'1.2-2' }} mm¬≥</p>
                                
                                <!-- Massa e Carga -->
                                <p class="mb-1"><b>Massa:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.massa }} g</p>
                                <p class="mb-2"><b>P M√°x:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.pMax | number:'1.2-4' }} kN</p>
                                
                                <!-- Tempos -->
                                <p class="mb-1"><b>Tempo 1:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.tempo1 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 2:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.tempo2 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 3:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.tempo3 }} ¬µs</p>
                                <p class="mb-2"><b>Menor Tempo:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.menorTempo }} ¬µs</p>
                                
                                <!-- Velocidade -->
                                <p class="mb-0"><b>Velocidade:</b> {{ analiseSelecionada.modulo_elasticidade.cp2.velocidade | number:'1.2-4' }} km/s</p>
                            </div>
                        </div>
                    </div>

                    <!-- CP3 -->
                    <div class="col-12 md:col-6 lg:col-4" *ngIf="analiseSelecionada.modulo_elasticidade.cp3">
                        <div
                            class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                            style="border-radius: 12px; background-color: #3b3b32; min-height: 380px;"
                        >
                            <div class="flex align-items-center mb-3">
                                <i class="pi pi-building" style="color: #fff3b0; font-size: 1.2rem; margin-right: 8px;"></i>
                                <h5 class="m-0" style="color: #fff3b0;">CP3</h5>
                            </div>
                            <div style="color: #fff2a8; font-size: 0.85rem;">
                                <!-- Resultado Principal -->
                                <div class="mb-3 p-2 text-center" style="background-color: rgba(255, 243, 176, 0.15); border-radius: 8px;">
                                    <p class="mb-1" style="color: #fff3b0; font-size: 0.75rem;">Ed (MPa)</p>
                                    <p class="mb-0 font-bold" style="color: #fff3b0; font-size: 1.3rem;">
                                        {{ analiseSelecionada.modulo_elasticidade.cp3.ed | number:'1.2-4' }}
                                    </p>
                                </div>
                                
                                <!-- Dimens√µes -->
                                <p class="mb-1"><b>Comprimento:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.comprimento }} mm</p>
                                <p class="mb-1"><b>Largura:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.largura }} mm</p>
                                <p class="mb-1"><b>Altura:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.altura }} mm</p>
                                <p class="mb-2"><b>Volume:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.volume | number:'1.2-2' }} mm¬≥</p>
                                
                                <!-- Massa e Carga -->
                                <p class="mb-1"><b>Massa:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.massa }} g</p>
                                <p class="mb-2"><b>P M√°x:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.pMax | number:'1.2-4' }} kN</p>
                                
                                <!-- Tempos -->
                                <p class="mb-1"><b>Tempo 1:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.tempo1 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 2:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.tempo2 }} ¬µs</p>
                                <p class="mb-1"><b>Tempo 3:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.tempo3 }} ¬µs</p>
                                <p class="mb-2"><b>Menor Tempo:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.menorTempo }} ¬µs</p>
                                
                                <!-- Velocidade -->
                                <p class="mb-0"><b>Velocidade:</b> {{ analiseSelecionada.modulo_elasticidade.cp3.velocidade | number:'1.2-4' }} km/s</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Cards de Deslizamento (Colantes) -->
            <div *ngIf="analiseSelecionada?.deslizamento">
                <h3 class="mb-3" style="color: #e6defa;">üìè Deslizamento (Colantes)</h3>
                
                <!-- Card de Resultado Principal -->
                <div class="mb-4" *ngIf="analiseSelecionada.deslizamento.resultado !== null && analiseSelecionada.deslizamento.resultado !== undefined">
                    <div class="shadow-3 hover:shadow-5 transition-duration-200 p-4" 
                         style="border-radius: 12px; background: linear-gradient(135deg, #8b4789 0%, #6a3567 100%);">
                        <div class="flex align-items-center justify-content-between">
                            <div>
                                <p class="text-white text-sm mb-2 font-semibold">Resultado do Deslizamento</p>
                                <p class="text-white text-5xl font-bold m-0">
                                    {{ analiseSelecionada.deslizamento.resultado | number:'1.2-2' }} mm
                                </p>
                            </div>
                            <i class="pi pi-arrow-down-right text-6xl text-white" style="opacity: 0.3;"></i>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Medidas -->
                <div class="mb-4">
                    <div class="shadow-2 p-3" style="border-radius: 12px; background-color: #2b3a55;">
                        <h4 class="mb-3 text-white">üìä Medidas</h4>
                        <div class="grid">
                            <!-- Medidas Iniciais -->
                            <div class="col-12 lg:col-6">
                                <div class="p-3" style="border-radius: 8px; background-color: rgba(139, 71, 137, 0.2); border-left: 4px solid #8b4789;">
                                    <h5 class="mb-3" style="color: #8b4789;">Medidas Iniciais (mm)</h5>
                                    <div class="grid">
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_inicial_1 !== null && analiseSelecionada.deslizamento.medida_inicial_1 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 1</p>
                                            <p class="font-bold mb-0" style="color: #8b4789;">{{ analiseSelecionada.deslizamento.medida_inicial_1 | number:'1.2-2' }}</p>
                                        </div>
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_inicial_2 !== null && analiseSelecionada.deslizamento.medida_inicial_2 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 2</p>
                                            <p class="font-bold mb-0" style="color: #8b4789;">{{ analiseSelecionada.deslizamento.medida_inicial_2 | number:'1.2-2' }}</p>
                                        </div>
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_inicial_3 !== null && analiseSelecionada.deslizamento.medida_inicial_3 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 3</p>
                                            <p class="font-bold mb-0" style="color: #8b4789;">{{ analiseSelecionada.deslizamento.medida_inicial_3 | number:'1.2-2' }}</p>
                                        </div>
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_inicial_4 !== null && analiseSelecionada.deslizamento.medida_inicial_4 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 4</p>
                                            <p class="font-bold mb-0" style="color: #8b4789;">{{ analiseSelecionada.deslizamento.medida_inicial_4 | number:'1.2-2' }}</p>
                                        </div>
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_inicial_5 !== null && analiseSelecionada.deslizamento.medida_inicial_5 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 5</p>
                                            <p class="font-bold mb-0" style="color: #8b4789;">{{ analiseSelecionada.deslizamento.medida_inicial_5 | number:'1.2-2' }}</p>
                                        </div>
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_inicial_6 !== null && analiseSelecionada.deslizamento.medida_inicial_6 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 6</p>
                                            <p class="font-bold mb-0" style="color: #8b4789;">{{ analiseSelecionada.deslizamento.medida_inicial_6 | number:'1.2-2' }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Medidas Finais -->
                            <div class="col-12 lg:col-6">
                                <div class="p-3" style="border-radius: 8px; background-color: rgba(136, 36, 71, 0.2); border-left: 4px solid #882447;">
                                    <h5 class="mb-3" style="color: #882447;">Medidas Finais (mm)</h5>
                                    <div class="grid">
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_final_1 !== null && analiseSelecionada.deslizamento.medida_final_1 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 1</p>
                                            <p class="font-bold mb-0" style="color: #882447;">{{ analiseSelecionada.deslizamento.medida_final_1 | number:'1.2-2' }}</p>
                                        </div>
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_final_2 !== null && analiseSelecionada.deslizamento.medida_final_2 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 2</p>
                                            <p class="font-bold mb-0" style="color: #882447;">{{ analiseSelecionada.deslizamento.medida_final_2 | number:'1.2-2' }}</p>
                                        </div>
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_final_3 !== null && analiseSelecionada.deslizamento.medida_final_3 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 3</p>
                                            <p class="font-bold mb-0" style="color: #882447;">{{ analiseSelecionada.deslizamento.medida_final_3 | number:'1.2-2' }}</p>
                                        </div>
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_final_4 !== null && analiseSelecionada.deslizamento.medida_final_4 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 4</p>
                                            <p class="font-bold mb-0" style="color: #882447;">{{ analiseSelecionada.deslizamento.medida_final_4 | number:'1.2-2' }}</p>
                                        </div>
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_final_5 !== null && analiseSelecionada.deslizamento.medida_final_5 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 5</p>
                                            <p class="font-bold mb-0" style="color: #882447;">{{ analiseSelecionada.deslizamento.medida_final_5 | number:'1.2-2' }}</p>
                                        </div>
                                        <div class="col-6 md:col-4" *ngIf="analiseSelecionada.deslizamento.medida_final_6 !== null && analiseSelecionada.deslizamento.medida_final_6 !== undefined">
                                            <p class="text-xs mb-1" style="color: #999;">Medida 6</p>
                                            <p class="font-bold mb-0" style="color: #882447;">{{ analiseSelecionada.deslizamento.medida_final_6 | number:'1.2-2' }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cards de Peneiras Secas -->
            <div *ngIf="analiseSelecionada?.peneiras?.peneiras && analiseSelecionada.peneiras.peneiras.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üî¨ Peneiras Secas</h3>
                
                <!-- Informa√ß√µes Gerais -->
                <div class="mb-4">
                    <div class="grid">
                        <div class="col-12 md:col-6">
                            <div
                                class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                                style="border-radius: 12px; background-color: #2b3a55;"
                            >
                                <div class="flex align-items-center justify-content-center">
                                    <i class="pi pi-box mr-2" style="color: #b3e5ff; font-size: 1.5rem;"></i>
                                    <div>
                                        <p class="mb-1" style="color: #d6f1ff; font-size: 0.8rem;">Massa da Amostra</p>
                                        <p class="mb-0" style="color: #b3e5ff; font-size: 1.5rem; font-weight: 700;">
                                            {{ analiseSelecionada.peneiras.amostra | number:'1.2-2' }} g
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 md:col-6">
                            <div
                                class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                                style="border-radius: 12px; background-color: #26413c;"
                            >
                                <div class="flex align-items-center justify-content-center">
                                    <i class="pi pi-filter mr-2" style="color: #b2f5ea; font-size: 1.5rem;"></i>
                                    <div>
                                        <p class="mb-1" style="color: #ccfbf1; font-size: 0.8rem;">Total de Finos</p>
                                        <p class="mb-0" style="color: #b2f5ea; font-size: 1.5rem; font-weight: 700;">
                                            {{ analiseSelecionada.peneiras.finos | number:'1.2-2' }} g
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Peneiras -->
                <div class="mb-3">
                    <div
                        class="shadow-2 p-3"
                        style="border-radius: 12px; background-color: #2b3a55; overflow-x: auto;"
                    >
                        <p-table [value]="analiseSelecionada.peneiras.peneiras" styleClass="p-datatable-sm">
                            <ng-template pTemplate="header">
                                <tr style="background-color: rgba(179, 229, 255, 0.1);">
                                    <th style="color: #b3e5ff;">Peneira</th>
                                    <th style="color: #b3e5ff;">Retido (g)</th>
                                    <th style="color: #b3e5ff;">Retido (%)</th>
                                    <th style="color: #b3e5ff;">Passante (%)</th>
                                    <th style="color: #b3e5ff;">Acumulado (%)</th>
                                    <th style="color: #b3e5ff;">Passante Acumulado (%)</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-linha>
                                <tr style="color: #d6f1ff;">
                                    <td><b>{{ linha.peneira }}</b></td>
                                    <td>{{ linha.valor_retido | number:'1.2-2' }}</td>
                                    <td>{{ linha.porcentual_retido | number:'1.2-2' }}</td>
                                    <td>{{ linha.passante | number:'1.2-2' }}</td>
                                    <td>{{ linha.acumulado | number:'1.2-2' }}</td>
                                    <td>{{ linha.passante_acumulado | number:'1.2-2' }}</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>

            <!-- Cards de Peneiras √ömidas -->
            <div *ngIf="analiseSelecionada?.peneiras_umidas?.peneiras && analiseSelecionada.peneiras_umidas.peneiras.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üíß Peneiras √ömidas</h3>
                
                <!-- Informa√ß√µes Gerais -->
                <div class="mb-4">
                    <div class="grid">
                        <div class="col-12 md:col-6">
                            <div
                                class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                                style="border-radius: 12px; background-color: #2b3a55;"
                            >
                                <div class="flex align-items-center justify-content-center">
                                    <i class="pi pi-box mr-2" style="color: #b3e5ff; font-size: 1.5rem;"></i>
                                    <div>
                                        <p class="mb-1" style="color: #d6f1ff; font-size: 0.8rem;">Massa da Amostra</p>
                                        <p class="mb-0" style="color: #b3e5ff; font-size: 1.5rem; font-weight: 700;">
                                            {{ analiseSelecionada.peneiras_umidas.amostra | number:'1.2-2' }} g
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 md:col-6">
                            <div
                                class="shadow-2 hover:shadow-4 transition-duration-200 p-3"
                                style="border-radius: 12px; background-color: #26413c;"
                            >
                                <div class="flex align-items-center justify-content-center">
                                    <i class="pi pi-filter mr-2" style="color: #b2f5ea; font-size: 1.5rem;"></i>
                                    <div>
                                        <p class="mb-1" style="color: #ccfbf1; font-size: 0.8rem;">Total de Finos</p>
                                        <p class="mb-0" style="color: #b2f5ea; font-size: 1.5rem; font-weight: 700;">
                                            {{ analiseSelecionada.peneiras_umidas.finos | number:'1.2-2' }} g
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Peneiras √ömidas -->
                <div class="mb-3">
                    <div
                        class="shadow-2 p-3"
                        style="border-radius: 12px; background-color: #26413c; overflow-x: auto;"
                    >
                        <p-table [value]="analiseSelecionada.peneiras_umidas.peneiras" styleClass="p-datatable-sm">
                            <ng-template pTemplate="header">
                                <tr style="background-color: rgba(178, 245, 234, 0.1);">
                                    <th style="color: #b2f5ea;">Peneira</th>
                                    <th style="color: #b2f5ea;">Retido (g)</th>
                                    <th style="color: #b2f5ea;">Retido (%)</th>
                                    <th style="color: #b2f5ea;">Passante (%)</th>
                                    <th style="color: #b2f5ea;">Acumulado (%)</th>
                                    <th style="color: #b2f5ea;">Passante Acumulado (%)</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-linha>
                                <tr style="color: #ccfbf1;">
                                    <td><b>{{ linha.peneira }}</b></td>
                                    <td>{{ linha.valor_retido | number:'1.2-2' }}</td>
                                    <td>{{ linha.porcentual_retido | number:'1.2-2' }}</td>
                                    <td>{{ linha.passante | number:'1.2-2' }}</td>
                                    <td>{{ linha.acumulado | number:'1.2-2' }}</td>
                                    <td>{{ linha.passante_acumulado | number:'1.2-2' }}</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>

            <!-- Cards de Substrato -->
            <div *ngIf="analiseSelecionada?.substrato?.linhas && analiseSelecionada.substrato.linhas.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üèóÔ∏è Resist√™ncia de Ader√™ncia ao Substrato</h3>
                
                <!-- M√©dia Geral -->
                <div class="mb-4" *ngIf="analiseSelecionada.substrato.media">
                    <div
                        class="shadow-2 hover:shadow-4 transition-duration-200 p-4"
                        style="border-radius: 12px; background-color: #4a4458;"
                    >
                        <div class="flex align-items-center justify-content-center">
                            <i class="pi pi-chart-line mr-3" style="color: #e3d8ff; font-size: 2rem;"></i>
                            <div class="text-center">
                                <p class="mb-1" style="color: #e6defa; font-size: 0.9rem;">Resist√™ncia M√©dia</p>
                                <p class="mb-0" style="color: #e3d8ff; font-size: 2rem; font-weight: 700;">
                                    {{ analiseSelecionada.substrato.media | number:'1.2-2' }} MPa
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Substrato -->
                <div class="mb-3">
                    <div
                        class="shadow-2 p-3"
                        style="border-radius: 12px; background-color: #2b3a55; overflow-x: auto;"
                    >
                        <p-table [value]="analiseSelecionada.substrato.linhas" styleClass="p-datatable-sm">
                            <ng-template pTemplate="header">
                                <tr style="background-color: rgba(179, 229, 255, 0.1);">
                                    <th style="color: #b3e5ff;">N¬∫</th>
                                    <th style="color: #b3e5ff;">Di√¢metro (mm)</th>
                                    <th style="color: #b3e5ff;">√Årea (cm¬≤)</th>
                                    <th style="color: #b3e5ff;">Espessura (mm)</th>
                                    <th style="color: #b3e5ff;">Subst (mm)</th>
                                    <th style="color: #b3e5ff;">Junta (mm)</th>
                                    <th style="color: #b3e5ff;">Carga (kN)</th>
                                    <th style="color: #b3e5ff;">Resist√™ncia (MPa)</th>
                                    <th style="color: #b3e5ff;">Valida√ß√£o</th>
                                    <th style="color: #b3e5ff;">Rupturas</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-linha>
                                <tr style="color: #d6f1ff;">
                                    <td><b>{{ linha.numero }}</b></td>
                                    <td>{{ linha.diametro | number:'1.2-2' }}</td>
                                    <td>{{ linha.area | number:'1.2-2' }}</td>
                                    <td>{{ linha.espessura | number:'1.2-2' }}</td>
                                    <td>{{ linha.subst | number:'1.2-2' }}</td>
                                    <td>{{ linha.junta | number:'1.2-2' }}</td>
                                    <td>{{ linha.carga | number:'1.2-2' }}</td>
                                    <td><b>{{ linha.resist | number:'1.2-2' }}</b></td>
                                    <td>
                                        <span 
                                            [style.color]="linha.validacao === 'V√°lido' ? '#10b981' : linha.validacao === 'Inv√°lido' ? '#ef4444' : '#d6f1ff'"
                                            [style.font-weight]="'bold'"
                                        >
                                            {{ linha.validacao || '-' }}
                                        </span>
                                    </td>
                                    <td style="font-size: 0.85rem;">
                                        <div *ngIf="linha.rupturas">
                                            <span *ngIf="linha.rupturas.sub"><b>Sub:</b> {{ linha.rupturas.sub }}</span>
                                            <span *ngIf="linha.rupturas.subArga"> | <b>SubArga:</b> {{ linha.rupturas.subArga }}</span>
                                            <span *ngIf="linha.rupturas.rupArga"> | <b>RupArga:</b> {{ linha.rupturas.rupArga }}</span>
                                            <span *ngIf="linha.rupturas.argaCola"> | <b>ArgaCola:</b> {{ linha.rupturas.argaCola }}</span>
                                            <span *ngIf="linha.rupturas.colarPastilha"> | <b>ColarPast:</b> {{ linha.rupturas.colarPastilha }}</span>
                                        </div>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>

            <!-- Cards de Superficial -->
            <div *ngIf="analiseSelecionada?.superficial?.linhas && analiseSelecionada.superficial.linhas.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üîç Resist√™ncia de Ader√™ncia Superficial</h3>
                
                <!-- M√©dia Geral -->
                <div class="mb-4" *ngIf="analiseSelecionada.superficial.media">
                    <div
                        class="shadow-2 hover:shadow-4 transition-duration-200 p-4"
                        style="border-radius: 12px; background-color: #26413c;"
                    >
                        <div class="flex align-items-center justify-content-center">
                            <i class="pi pi-chart-line mr-3" style="color: #b2f5ea; font-size: 2rem;"></i>
                            <div class="text-center">
                                <p class="mb-1" style="color: #ccfbf1; font-size: 0.9rem;">Resist√™ncia M√©dia</p>
                                <p class="mb-0" style="color: #b2f5ea; font-size: 2rem; font-weight: 700;">
                                    {{ analiseSelecionada.superficial.media | number:'1.2-2' }} MPa
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Superficial -->
                <div class="mb-3">
                    <div
                        class="shadow-2 p-3"
                        style="border-radius: 12px; background-color: #26413c; overflow-x: auto;"
                    >
                        <p-table [value]="analiseSelecionada.superficial.linhas" styleClass="p-datatable-sm">
                            <ng-template pTemplate="header">
                                <tr style="background-color: rgba(178, 245, 234, 0.1);">
                                    <th style="color: #b2f5ea;">N¬∫</th>
                                    <th style="color: #b2f5ea;">Di√¢metro (mm)</th>
                                    <th style="color: #b2f5ea;">√Årea (cm¬≤)</th>
                                    <th style="color: #b2f5ea;">Espessura (mm)</th>
                                    <th style="color: #b2f5ea;">Subst (mm)</th>
                                    <th style="color: #b2f5ea;">Junta (mm)</th>
                                    <th style="color: #b2f5ea;">Carga (kN)</th>
                                    <th style="color: #b2f5ea;">Resist√™ncia (MPa)</th>
                                    <th style="color: #b2f5ea;">Valida√ß√£o</th>
                                    <th style="color: #b2f5ea;">Rupturas</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-linha>
                                <tr style="color: #ccfbf1;">
                                    <td><b>{{ linha.numero }}</b></td>
                                    <td>{{ linha.diametro | number:'1.2-2' }}</td>
                                    <td>{{ linha.area | number:'1.2-2' }}</td>
                                    <td>{{ linha.espessura | number:'1.2-2' }}</td>
                                    <td>{{ linha.subst | number:'1.2-2' }}</td>
                                    <td>{{ linha.junta | number:'1.2-2' }}</td>
                                    <td>{{ linha.carga | number:'1.2-2' }}</td>
                                    <td><b>{{ linha.resist | number:'1.2-2' }}</b></td>
                                    <td>
                                        <span 
                                            [style.color]="linha.validacao === 'V√°lido' ? '#10b981' : linha.validacao === 'Inv√°lido' ? '#ef4444' : '#ccfbf1'"
                                            [style.font-weight]="'bold'"
                                        >
                                            {{ linha.validacao || '-' }}
                                        </span>
                                    </td>
                                    <td style="font-size: 0.85rem;">
                                        <div *ngIf="linha.rupturas">
                                            <span *ngIf="linha.rupturas.sub"><b>Sub:</b> {{ linha.rupturas.sub }}</span>
                                            <span *ngIf="linha.rupturas.subArga"> | <b>SubArga:</b> {{ linha.rupturas.subArga }}</span>
                                            <span *ngIf="linha.rupturas.rupArga"> | <b>RupArga:</b> {{ linha.rupturas.rupArga }}</span>
                                            <span *ngIf="linha.rupturas.argaCola"> | <b>ArgaCola:</b> {{ linha.rupturas.argaCola }}</span>
                                            <span *ngIf="linha.rupturas.colarPastilha"> | <b>ColarPast:</b> {{ linha.rupturas.colarPastilha }}</span>
                                        </div>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>

            <!-- Cards de Tra√ß√£o Normal -->
            <div *ngIf="analiseSelecionada?.tracao_normal?.linhas && analiseSelecionada.tracao_normal.linhas.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üí™ Tra√ß√£o Normal</h3>
                
                <!-- M√©dia Geral -->
                <div class="mb-4" *ngIf="analiseSelecionada.tracao_normal.media">
                    <div
                        class="shadow-2 hover:shadow-4 transition-duration-200 p-4"
                        style="border-radius: 12px; background-color: #3b3b32;"
                    >
                        <div class="flex align-items-center justify-content-center">
                            <i class="pi pi-chart-line mr-3" style="color: #fff3b0; font-size: 2rem;"></i>
                            <div class="text-center">
                                <p class="mb-1" style="color: #fff2a8; font-size: 0.9rem;">Resist√™ncia M√©dia</p>
                                <p class="mb-0" style="color: #fff3b0; font-size: 2rem; font-weight: 700;">
                                    {{ analiseSelecionada.tracao_normal.media | number:'1.2-2' }} MPa
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Tra√ß√£o Normal -->
                <div class="mb-3">
                    <div
                        class="shadow-2 p-3"
                        style="border-radius: 12px; background-color: #3b3b32; overflow-x: auto;"
                    >
                        <p-table [value]="analiseSelecionada.tracao_normal.linhas" styleClass="p-datatable-sm">
                            <ng-template pTemplate="header">
                                <tr style="background-color: rgba(255, 243, 176, 0.1);">
                                    <th style="color: #fff3b0;">N¬∫</th>
                                    <th style="color: #fff3b0;">Di√¢metro (mm)</th>
                                    <th style="color: #fff3b0;">√Årea (cm¬≤)</th>
                                    <th style="color: #fff3b0;">Espessura (mm)</th>
                                    <th style="color: #fff3b0;">Subst (mm)</th>
                                    <th style="color: #fff3b0;">Junta (mm)</th>
                                    <th style="color: #fff3b0;">Carga (kN)</th>
                                    <th style="color: #fff3b0;">Resist√™ncia (MPa)</th>
                                    <th style="color: #fff3b0;">Valida√ß√£o</th>
                                    <th style="color: #fff3b0;">Rupturas</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-linha>
                                <tr style="color: #fff2a8;">
                                    <td><b>{{ linha.numero }}</b></td>
                                    <td>{{ linha.diametro | number:'1.2-2' }}</td>
                                    <td>{{ linha.area | number:'1.2-2' }}</td>
                                    <td>{{ linha.espessura | number:'1.2-2' }}</td>
                                    <td>{{ linha.subst | number:'1.2-2' }}</td>
                                    <td>{{ linha.junta | number:'1.2-2' }}</td>
                                    <td>{{ linha.carga | number:'1.2-2' }}</td>
                                    <td><b>{{ linha.resist | number:'1.2-2' }}</b></td>
                                    <td>
                                        <span 
                                            [style.color]="linha.validacao === 'V√°lido' ? '#10b981' : linha.validacao === 'Inv√°lido' ? '#ef4444' : '#fff2a8'"
                                            [style.font-weight]="'bold'"
                                        >
                                            {{ linha.validacao || '-' }}
                                        </span>
                                    </td>
                                    <td style="font-size: 0.85rem;">
                                        <div *ngIf="linha.rupturas">
                                            <span *ngIf="linha.rupturas.sub"><b>Sub:</b> {{ linha.rupturas.sub }}</span>
                                            <span *ngIf="linha.rupturas.subArga"> | <b>SubArga:</b> {{ linha.rupturas.subArga }}</span>
                                            <span *ngIf="linha.rupturas.rupArga"> | <b>RupArga:</b> {{ linha.rupturas.rupArga }}</span>
                                            <span *ngIf="linha.rupturas.argaCola"> | <b>ArgaCola:</b> {{ linha.rupturas.argaCola }}</span>
                                            <span *ngIf="linha.rupturas.colarPastilha"> | <b>ColarPast:</b> {{ linha.rupturas.colarPastilha }}</span>
                                        </div>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>

            <!-- Cards de Tra√ß√£o Submersa -->
            <div *ngIf="analiseSelecionada?.tracao_submersa?.linhas && analiseSelecionada.tracao_submersa.linhas.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üåä Tra√ß√£o Submersa</h3>
                
                <!-- M√©dia Geral -->
                <div class="mb-4" *ngIf="analiseSelecionada.tracao_submersa.media">
                    <div
                        class="shadow-2 hover:shadow-4 transition-duration-200 p-4"
                        style="border-radius: 12px; background-color: #2b3a55;"
                    >
                        <div class="flex align-items-center justify-content-center">
                            <i class="pi pi-chart-line mr-3" style="color: #a8b8d8; font-size: 2rem;"></i>
                            <div class="text-center">
                                <p class="mb-1" style="color: #c8d4e8; font-size: 0.9rem;">Resist√™ncia M√©dia</p>
                                <p class="mb-0" style="color: #a8b8d8; font-size: 2rem; font-weight: 700;">
                                    {{ analiseSelecionada.tracao_submersa.media | number:'1.2-2' }} MPa
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Tra√ß√£o Submersa -->
                <div class="mb-3">
                    <div
                        class="shadow-2 p-3"
                        style="border-radius: 12px; background-color: #2b3a55; overflow-x: auto;"
                    >
                        <p-table [value]="analiseSelecionada.tracao_submersa.linhas" styleClass="p-datatable-sm">
                            <ng-template pTemplate="header">
                                <tr style="background-color: rgba(168, 184, 216, 0.1);">
                                    <th style="color: #a8b8d8;">N¬∫</th>
                                    <th style="color: #a8b8d8;">Di√¢metro (mm)</th>
                                    <th style="color: #a8b8d8;">√Årea (cm¬≤)</th>
                                    <th style="color: #a8b8d8;">Espessura (mm)</th>
                                    <th style="color: #a8b8d8;">Subst (mm)</th>
                                    <th style="color: #a8b8d8;">Junta (mm)</th>
                                    <th style="color: #a8b8d8;">Carga (kN)</th>
                                    <th style="color: #a8b8d8;">Resist√™ncia (MPa)</th>
                                    <th style="color: #a8b8d8;">Valida√ß√£o</th>
                                    <th style="color: #a8b8d8;">Rupturas</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-linha>
                                <tr style="color: #c8d4e8;">
                                    <td><b>{{ linha.numero }}</b></td>
                                    <td>{{ linha.diametro | number:'1.2-2' }}</td>
                                    <td>{{ linha.area | number:'1.2-2' }}</td>
                                    <td>{{ linha.espessura | number:'1.2-2' }}</td>
                                    <td>{{ linha.subst | number:'1.2-2' }}</td>
                                    <td>{{ linha.junta | number:'1.2-2' }}</td>
                                    <td>{{ linha.carga | number:'1.2-2' }}</td>
                                    <td><b>{{ linha.resist | number:'1.2-2' }}</b></td>
                                    <td>
                                        <span 
                                            [style.color]="linha.validacao === 'V√°lido' ? '#10b981' : linha.validacao === 'Inv√°lido' ? '#ef4444' : '#c8d4e8'"
                                            [style.font-weight]="'bold'"
                                        >
                                            {{ linha.validacao || '-' }}
                                        </span>
                                    </td>
                                    <td style="font-size: 0.85rem;">
                                        <div *ngIf="linha.rupturas">
                                            <span *ngIf="linha.rupturas.sub"><b>Sub:</b> {{ linha.rupturas.sub }}</span>
                                            <span *ngIf="linha.rupturas.subArga"> | <b>SubArga:</b> {{ linha.rupturas.subArga }}</span>
                                            <span *ngIf="linha.rupturas.rupArga"> | <b>RupArga:</b> {{ linha.rupturas.rupArga }}</span>
                                            <span *ngIf="linha.rupturas.argaCola"> | <b>ArgaCola:</b> {{ linha.rupturas.argaCola }}</span>
                                            <span *ngIf="linha.rupturas.colarPastilha"> | <b>ColarPast:</b> {{ linha.rupturas.colarPastilha }}</span>
                                        </div>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>

            <!-- Cards de Tra√ß√£o Estufa -->
            <div *ngIf="analiseSelecionada?.tracao_estufa?.linhas && analiseSelecionada.tracao_estufa.linhas.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">üî• Tra√ß√£o Estufa</h3>
                
                <!-- M√©dia Geral -->
                <div class="mb-4" *ngIf="analiseSelecionada.tracao_estufa.media">
                    <div
                        class="shadow-2 hover:shadow-4 transition-duration-200 p-4"
                        style="border-radius: 12px; background-color: #4a4458;"
                    >
                        <div class="flex align-items-center justify-content-center">
                            <i class="pi pi-chart-line mr-3" style="color: #c8b6e2; font-size: 2rem;"></i>
                            <div class="text-center">
                                <p class="mb-1" style="color: #d8c8f0; font-size: 0.9rem;">Resist√™ncia M√©dia</p>
                                <p class="mb-0" style="color: #c8b6e2; font-size: 2rem; font-weight: 700;">
                                    {{ analiseSelecionada.tracao_estufa.media | number:'1.2-2' }} MPa
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Tra√ß√£o Estufa -->
                <div class="mb-3">
                    <div
                        class="shadow-2 p-3"
                        style="border-radius: 12px; background-color: #4a4458; overflow-x: auto;"
                    >
                        <p-table [value]="analiseSelecionada.tracao_estufa.linhas" styleClass="p-datatable-sm">
                            <ng-template pTemplate="header">
                                <tr style="background-color: rgba(200, 182, 226, 0.1);">
                                    <th style="color: #c8b6e2;">N¬∫</th>
                                    <th style="color: #c8b6e2;">Di√¢metro (mm)</th>
                                    <th style="color: #c8b6e2;">√Årea (cm¬≤)</th>
                                    <th style="color: #c8b6e2;">Espessura (mm)</th>
                                    <th style="color: #c8b6e2;">Subst (mm)</th>
                                    <th style="color: #c8b6e2;">Junta (mm)</th>
                                    <th style="color: #c8b6e2;">Carga (kN)</th>
                                    <th style="color: #c8b6e2;">Resist√™ncia (MPa)</th>
                                    <th style="color: #c8b6e2;">Valida√ß√£o</th>
                                    <th style="color: #c8b6e2;">Rupturas</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-linha>
                                <tr style="color: #d8c8f0;">
                                    <td><b>{{ linha.numero }}</b></td>
                                    <td>{{ linha.diametro | number:'1.2-2' }}</td>
                                    <td>{{ linha.area | number:'1.2-2' }}</td>
                                    <td>{{ linha.espessura | number:'1.2-2' }}</td>
                                    <td>{{ linha.subst | number:'1.2-2' }}</td>
                                    <td>{{ linha.junta | number:'1.2-2' }}</td>
                                    <td>{{ linha.carga | number:'1.2-2' }}</td>
                                    <td><b>{{ linha.resist | number:'1.2-2' }}</b></td>
                                    <td>
                                        <span 
                                            [style.color]="linha.validacao === 'V√°lido' ? '#10b981' : linha.validacao === 'Inv√°lido' ? '#ef4444' : '#d8c8f0'"
                                            [style.font-weight]="'bold'"
                                        >
                                            {{ linha.validacao || '-' }}
                                        </span>
                                    </td>
                                    <td style="font-size: 0.85rem;">
                                        <div *ngIf="linha.rupturas">
                                            <span *ngIf="linha.rupturas.sub"><b>Sub:</b> {{ linha.rupturas.sub }}</span>
                                            <span *ngIf="linha.rupturas.subArga"> | <b>SubArga:</b> {{ linha.rupturas.subArga }}</span>
                                            <span *ngIf="linha.rupturas.rupArga"> | <b>RupArga:</b> {{ linha.rupturas.rupArga }}</span>
                                            <span *ngIf="linha.rupturas.argaCola"> | <b>ArgaCola:</b> {{ linha.rupturas.argaCola }}</span>
                                            <span *ngIf="linha.rupturas.colarPastilha"> | <b>ColarPast:</b> {{ linha.rupturas.colarPastilha }}</span>
                                        </div>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>

            <!-- Cards de Tra√ß√£o Tempo Aberto -->
            <div *ngIf="analiseSelecionada?.tracao_tempo_aberto?.linhas && analiseSelecionada.tracao_tempo_aberto.linhas.length > 0">
                <h3 class="mb-3" style="color: #e6defa;">‚è±Ô∏è Tra√ß√£o Tempo Aberto</h3>
                
                <!-- M√©dia Geral -->
                <div class="mb-4" *ngIf="analiseSelecionada.tracao_tempo_aberto.media && typeof analiseSelecionada.tracao_tempo_aberto.media === 'number'">
                    <div
                        class="shadow-2 hover:shadow-4 transition-duration-200 p-4"
                        style="border-radius: 12px; background-color: #26413c;"
                    >
                        <div class="flex align-items-center justify-content-center">
                            <i class="pi pi-chart-line mr-3" style="color: #88c0b4; font-size: 2rem;"></i>
                            <div class="text-center">
                                <p class="mb-1" style="color: #a0d4c8; font-size: 0.9rem;">Resist√™ncia M√©dia</p>
                                <p class="mb-0" style="color: #88c0b4; font-size: 2rem; font-weight: 700;">
                                    {{ analiseSelecionada.tracao_tempo_aberto.media | number:'1.2-2' }} MPa
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Tra√ß√£o Tempo Aberto -->
                <div class="mb-3">
                    <div
                        class="shadow-2 p-3"
                        style="border-radius: 12px; background-color: #26413c; overflow-x: auto;"
                    >
                        <p-table [value]="analiseSelecionada.tracao_tempo_aberto.linhas" styleClass="p-datatable-sm">
                            <ng-template pTemplate="header">
                                <tr style="background-color: rgba(136, 192, 180, 0.1);">
                                    <th style="color: #88c0b4;">N¬∫</th>
                                    <th style="color: #88c0b4;">Di√¢metro (mm)</th>
                                    <th style="color: #88c0b4;">√Årea (cm¬≤)</th>
                                    <th style="color: #88c0b4;">Espessura (mm)</th>
                                    <th style="color: #88c0b4;">Subst (mm)</th>
                                    <th style="color: #88c0b4;">Junta (mm)</th>
                                    <th style="color: #88c0b4;">Carga (kN)</th>
                                    <th style="color: #88c0b4;">Resist√™ncia (MPa)</th>
                                    <th style="color: #88c0b4;">Valida√ß√£o</th>
                                    <th style="color: #88c0b4;">Rupturas</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-linha>
                                <tr style="color: #a0d4c8;">
                                    <td><b>{{ linha.numero }}</b></td>
                                    <td>{{ linha.diametro | number:'1.2-2' }}</td>
                                    <td>{{ linha.area | number:'1.2-2' }}</td>
                                    <td>{{ linha.espessura | number:'1.2-2' }}</td>
                                    <td>{{ linha.subst | number:'1.2-2' }}</td>
                                    <td>{{ linha.junta | number:'1.2-2' }}</td>
                                    <td>{{ linha.carga | number:'1.2-2' }}</td>
                                    <td><b>{{ linha.resist | number:'1.2-2' }}</b></td>
                                    <td>
                                        <span 
                                            [style.color]="linha.validacao === 'V√°lido' ? '#10b981' : linha.validacao === 'Inv√°lido' ? '#ef4444' : '#a0d4c8'"
                                            [style.font-weight]="'bold'"
                                        >
                                            {{ linha.validacao || '-' }}
                                        </span>
                                    </td>
                                    <td style="font-size: 0.85rem;">
                                        <div *ngIf="linha.rupturas">
                                            <span *ngIf="linha.rupturas.sub"><b>Sub:</b> {{ linha.rupturas.sub }}</span>
                                            <span *ngIf="linha.rupturas.subArga"> | <b>SubArga:</b> {{ linha.rupturas.subArga }}</span>
                                            <span *ngIf="linha.rupturas.rupArga"> | <b>RupArga:</b> {{ linha.rupturas.rupArga }}</span>
                                            <span *ngIf="linha.rupturas.argaCola"> | <b>ArgaCola:</b> {{ linha.rupturas.argaCola }}</span>
                                            <span *ngIf="linha.rupturas.colarPastilha"> | <b>ColarPast:</b> {{ linha.rupturas.colarPastilha }}</span>
                                        </div>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>

            <!-- <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                <p-button 
                    label="Gerar Impress√£o" 
                    (onClick)="imprimirVisualizar(analiseSelecionada)"
                    severity="success"
                    icon="pi pi-check" 
                    iconPos="right" 
                    tooltipPosition="top"
                    pTooltip="Gerar Impress√£o"
                />
            </div> -->

        </div>

    </p-drawer>

    <p-dialog 
        [(visible)]="modalLaudo" 
        [modal]="true" 
        [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" 
        [style]="{ width: '80vw' }" 
        [draggable]="false" 
        [resizable]="false"
    >
    <p-toast />
        
        <div class="containerInterno w-12">
            <div class="background-form">
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">

                        <p-card class="card w-12 text-center">
                            <ng-template #header>
                                <div class="header w-full text-center">
                                    <b>Selecionar √Ånalises do Laudo</b>
                                </div>
                            </ng-template>
                            <div class="flex flex-row w-12 gap-3">
                                <!-- Coluna da tabela -->
                                <div class="w-12">
                                    <p-table 
                                        [value]="ensaios_laudo" 
                                        [(selection)]="ensaios_selecionados" 
                                        dataKey="id"   
                                    >
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th style="width: 3em">
                                                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                            </th>
                                            <th>An√°lises</th>
                                            <th>Garantias</th>
                                        </tr>
                                    </ng-template>

                                    <ng-template pTemplate="body" let-ensaio>
                                        <tr [pSelectableRow]="ensaio">
                                        <td>
                                            <p-tableCheckbox [value]="ensaio"></p-tableCheckbox>
                                        </td>
                                            <td>{{ ensaio.descricao }}</td>
                                            <td>
                                                <input
                                                    pInputText
                                                    value="{{ ensaio.garantia }}"
                                                    type="text"
                                                    [(ngModel)]="ensaio.garantia"
                                                    placeholder="Digite a garantia"
                                                    class="form-control"
                                                />
                                            </td>
                                        </tr>
                                    </ng-template>
                                    </p-table>
                                </div>
                            </div>
                            
                            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                                <p-button 
                                    label="Gerar Laudo" 
                                    (onClick)="salvarSelecionados()"
                                    severity="success"
                                    icon="pi pi-check" 
                                    iconPos="right" 
                                    tooltipPosition="top"
                                    pTooltip="Gerar Laudo"
                                />
                            </div>
                        </p-card>
                    </div>    
                </div>
            </div>
        </div>
    </p-dialog>
    <canvas #graficoCanvas style="display: none;"></canvas>

    <!-- substrato -->
    <p-drawer 
        [(visible)]="modalDadosLaudoSubstrato" 
        position="full" >

         <div class="containerInterno w-12">
            <div class="background-form">
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">

                        <p-card class="card w-12 text-center card-substrato">
                            <ng-template #header>
                                <div class="header-substrato w-full text-center">
                                    <b>Determina√ß√£o da resist√™ncia potencial de ader√™ncia a tra√ß√£o ao substrato</b>
                                </div>
                            </ng-template>
                            <div class="flex flex-row w-12 gap-3">
                                <div class="w-12">
                                    <p-table [value]="linhas" stripedRows>
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th>N¬∫</th>
                                                <th>Di√¢metro mm</th>
                                                <th>√Årea mm¬≤</th>
                                                <th>Espessura mm</th>
                                                <th>Subst</th>
                                                <th>Junta</th>
                                                <th>Carga kgf</th>
                                                <th>RESIST. Mpa</th>
                                                <th>Valida√ß√£o</th>
                                                <th>(A) Sub</th>
                                                <th>(B) Sub/Arga</th>
                                                <th>(C) Rup Arga</th>
                                                <th>(D) Arga Cola</th>
                                                <th>(E) Colar pastilha</th>
                                            </tr>
                                        </ng-template>

                                        <ng-template pTemplate="body" let-linha let-i="rowIndex">
                                            <tr>
                                                <td>{{ linha.numero }}</td>
                                                <td><input [value]="linha.diametro" (input)="updateLinhaProperty(linha, 'diametro', $event)" type="number" class="form-control"/></td>
                                                <td><input [value]="linha.area" (input)="updateLinhaProperty(linha, 'area', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="linha.espessura" (input)="updateLinhaProperty(linha, 'espessura', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="linha.subst" (input)="updateLinhaProperty(linha, 'subst', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="linha.junta" (input)="updateLinhaProperty(linha, 'junta', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="linha.carga" (input)="updateLinhaProperty(linha, 'carga', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="linha.resist" (input)="updateLinhaProperty(linha, 'resist', $event)" type="number" step="0.01" class="form-control" /></td>
                                                <td><input [value]="linha.validacao" (input)="updateLinhaProperty(linha, 'validacao', $event)" type="text" class="form-control" /></td>
                                                <td><input [value]="linha.rupturas?.sub" (input)="updateLinhaRuptura(linha, 'sub', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="linha.rupturas?.subArga" (input)="updateLinhaRuptura(linha, 'subArga', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="linha.rupturas?.rupArga" (input)="updateLinhaRuptura(linha, 'rupArga', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="linha.rupturas?.argaCola" (input)="updateLinhaRuptura(linha, 'argaCola', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="linha.rupturas?.colarPastilha" (input)="updateLinhaRuptura(linha, 'colarPastilha', $event)" type="number" class="form-control" /></td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                </div>
                            </div>
                            
                            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                                <p-button 
                                    label="Salvar e ir para tra√ß√£o superficial" 
                                    (onClick)="abrirModalDadosLaudoSuperficial()"
                                    severity="warn"
                                    icon="pi pi-check" 
                                    iconPos="right" 
                                    tooltipPosition="top"
                                    pTooltip="Gerar Laudo"
                                />
                            </div>
                        </p-card>
                    </div>    
                </div>
            </div>
        </div>
       
    </p-drawer>

    <!-- superficial -->
    <p-drawer 
        [(visible)]="modalDadosLaudoSuperficial" 
        position="full" >
    <p-toast />
         <div class="containerInterno w-12">
            <div class="background-form">
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">

                        <p-card class="card w-12 text-center card-superficial">
                            <ng-template #header>
                                <div class="header-superficial w-full text-center">
                                    <b>Determina√ß√£o da resist√™ncia potencial de ader√™ncia a tra√ß√£o superficial</b>
                                </div>
                            </ng-template>
                            <div class="flex flex-row w-12 gap-3">
                                <div class="w-12">
                                    <p-table 
                                        [value]="linhasSuperficial" 
                                        stripedRows
                                    >
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th>N¬∫</th>
                                                <th>Di√¢metro mm</th>
                                                <th>√Årea mm¬≤</th>
                                                <th>Espessura mm</th>
                                                <th>Subst</th>
                                                <th>Junta</th>
                                                <th>Carga kgf</th>
                                                <th>RESIST. Mpa</th>
                                                <th>Valida√ß√£o</th>
                                                <th>(A) Sub</th>
                                                <th>(B) Sub/Arga</th>
                                                <th>(C) Rup Arga</th>
                                                <th>(D) Arga Cola</th>
                                                <th>(E) Colar pastilha</th>
                                            </tr>
                                        </ng-template>

                                        <ng-template pTemplate="body" let-numero let-i="rowIndex">
                                            <tr>
                                                <td>{{ numero.numero }}</td>
                                                <td><input [value]="numero.diametro" (input)="updateNumeroProperty(numero, 'diametro', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="numero.area" (input)="updateNumeroProperty(numero, 'area', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="numero.espessura" (input)="updateNumeroProperty(numero, 'espessura', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="numero.subst" (input)="updateNumeroProperty(numero, 'subst', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="numero.junta" (input)="updateNumeroProperty(numero, 'junta', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="numero.carga" (input)="updateNumeroProperty(numero, 'carga', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="numero.resist" (input)="updateNumeroProperty(numero, 'resist', $event)" type="number" step="0.01" class="form-control" /></td>
                                                <td><input [value]="numero.validacao" (input)="updateNumeroProperty(numero, 'validacao', $event)" type="text" class="form-control" /></td>
                                                <td><input [value]="numero.rupturas?.sub" (input)="updateNumeroRuptura(numero, 'sub', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="numero.rupturas?.subArga" (input)="updateNumeroRuptura(numero, 'subArga', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="numero.rupturas?.rupArga" (input)="updateNumeroRuptura(numero, 'rupArga', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="numero.rupturas?.argaCola" (input)="updateNumeroRuptura(numero, 'argaCola', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="numero.rupturas?.colarPastilha" (input)="updateNumeroRuptura(numero, 'colarPastilha', $event)" type="number" class="form-control" /></td>
                                            </tr>
                                        </ng-template>
                                    </p-table>

                                </div>
                            </div>
                            
                            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                                <p-button 
                                    label="Salvar tra√ß√£o superficial" 
                                    (onClick)="salvarSuperficial()"
                                    severity="info"
                                    icon="pi pi-check" 
                                    iconPos="right" 
                                    tooltipPosition="top"
                                    pTooltip="Salvar tra√ß√£o superficial"
                                />
                            </div>
                        </p-card>
                    </div>    
                </div>
            </div>
        </div>
       
    </p-drawer>

<!-- Modal para exibir o parecer da IA -->
<p-dialog
    header="Parecer T√©cnico - An√°lise Laboratorial"
    [(visible)]="mostrarParecer"
    [modal]="true"
    [closable]="true"
    [draggable]="false"
    [resizable]="false"
    [maximizable]="true"
    styleClass="parecer-modal"
>
    <div class="parecer-container">
        <div class="parecer-header mb-3">
            <i class="pi pi-robot mr-2" style="color: #3b82f6;"></i>
            <span class="font-semibold text-lg">An√°lise T√©cnica Automatizada</span>
        </div>
        
        <!-- Loading State -->
        <div *ngIf="parecerCarregando" class="parecer-loading text-center p-5">
            <p-progressSpinner strokeWidth="3" [style]="{ width: '50px', height: '50px' }"></p-progressSpinner>
            <p class="mt-3 text-600">Gerando parecer t√©cnico...</p>
            <small class="text-500">Por favor, aguarde enquanto o sistema consulta a ficha t√©cnica e as normas do produto.</small>
        </div>
        
        <!-- Content State -->
        <div *ngIf="!parecerCarregando && parecerResposta" class="parecer-conteudo" [innerHTML]="formatarParecer(parecerResposta)">
        </div>
        
        <!-- Empty State -->
        <div *ngIf="!parecerCarregando && !parecerResposta" class="parecer-empty text-center p-4">
            <i class="pi pi-exclamation-triangle text-4xl text-orange-400 mb-2"></i>
            <p class="text-600">Nenhum parecer dispon√≠vel</p>
        </div>
        
        <div *ngIf="!parecerCarregando" class="parecer-footer mt-4 text-center">
            <small class="text-500">
                <i class="pi pi-info-circle mr-1"></i>
                Este parecer foi gerado automaticamente por intelig√™ncia artificial
            </small>
        </div>
    </div>
    
    <ng-template pTemplate="footer">
        <p-button 
            label="Fechar" 
            icon="pi pi-times" 
            (onClick)="fecharParecer()"
            severity="secondary"
        ></p-button>
        <p-button 
            label="Copiar Texto" 
            icon="pi pi-copy" 
            (onClick)="copiarParecer()"
            severity="info"
            class="ml-2"
        ></p-button>
    </ng-template>
</p-dialog>

<!-- Loading overlay global para parecer da IA -->
<div *ngIf="parecerCarregando && !mostrarParecer" class="parecer-loading-overlay">
    <div class="loading-content">
        <p-progressSpinner strokeWidth="3" [style]="{ width: '60px', height: '60px' }"></p-progressSpinner>
        <h4 class="mt-3">Gerando Parecer T√©cnico</h4>
        <p class="text-600 mb-2">A IA est√° analisando os dados laboratoriais...</p>
        <small class="text-500">Por favor, aguarde. Isso pode levar alguns segundos.</small>
    </div>
</div>

    <!-- ruptura a flexao -->
    <p-drawer 
        [(visible)]="modalDadosLaudoFlexao" 
        position="full" >
    <p-toast />
         <div class="containerInterno w-12">
            <div class="background-form">
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">

                        <p-card class="card w-12 text-center card-superficial">
                            <ng-template #header>
                                <div class="header-flexao w-full text-center">
                                    <b>Carga de Ruptura a Flex√£o</b>
                                </div>
                            </ng-template>
                            <div class="flex flex-row w-12 gap-3">
                                <div class="w-12">
                                    <p-table 
                                        [value]="linhasFlexao" 
                                        stripedRows
                                    >
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th>CP</th>
                                                <th>Carga de Ruptura √† Flex√£o (N)</th>
                                                <th>Resist. √† Tra√ß√£o na Flex√£o (Mpa)</th>
                                                <th>Resist. M√©dia (Mpa)</th>
                                                <th>Resist. Tra√ß√£o Flex√£o</th>
                                            </tr>
                                        </ng-template>

                                        <ng-template pTemplate="body" let-flexao let-i="rowIndex">
                                            <tr>
                                                <td>{{ flexao.cp }}</td>
                                                <td><input [value]="flexao.flexao_n" (input)="updateFlexaoProperty(flexao, 'flexao_n', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="flexao.flexao_mpa" (input)="updateFlexaoProperty(flexao, 'flexao_mpa', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="flexao.media_mpa" (input)="updateFlexaoProperty(flexao, 'media_mpa', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="flexao.tracao_flexao" (input)="updateFlexaoProperty(flexao, 'tracao_flexao', $event)" type="number" class="form-control" /></td>
                                            </tr>
                                        </ng-template>
                                    </p-table>

                                </div>
                            </div>
                            
                            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                                <p-button 
                                    label="Salvar Ruptura a Flex√£o" 
                                    (onClick)="salvarRupturaFlexao()"
                                    severity="info"
                                    icon="pi pi-check" 
                                    iconPos="right" 
                                    tooltipPosition="top"
                                    pTooltip="Salvar Ruptura a Flex√£o"
                                    [style]="{'background-color': 'purple', 'border-color': 'purple'}"
                                />
                                
                            </div>
                        </p-card>
                    </div>    
                </div>
            </div>
        </div>
       
    </p-drawer>

    <!-- ruptura a compressao -->
    <p-drawer 
        [(visible)]="modalDadosLaudoCompressao" 
        position="full" >
    <p-toast />
         <div class="containerInterno w-12">
            <div class="background-form">
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">

                        <p-card class="card w-12 text-center card-superficial">
                            <ng-template #header>
                                <div class="header-compressao w-full text-center">
                                    <b>Carga de Ruptura a Compress√£o</b>
                                </div>
                            </ng-template>
                            <div class="flex flex-row w-12 gap-3">
                                <div class="w-12">
                                    <p-table 
                                        [value]="linhasCompressao" 
                                        stripedRows
                                    >
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th>CP</th>
                                                <th>Carga de Ruptura √† Compress√£o (N)</th>
                                                <th>Resist. √† Tra√ß√£o na Compress√£o (Mpa)</th>
                                                <th>Resist. M√©dia (Mpa)</th>
                                                <th>Resist. Tra√ß√£o Compress√£o</th>
                                            </tr>
                                        </ng-template>

                                        <ng-template pTemplate="body" let-compressao let-i="rowIndex">
                                            <tr>
                                                <td>{{ compressao.cp }}</td>
                                                <td><input [value]="compressao.compressao_n" (input)="updateCompressaoProperty(compressao, 'compressao_n', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="compressao.compressao_mpa" (input)="updateCompressaoProperty(compressao, 'compressao_mpa', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="compressao.media_mpa" (input)="updateCompressaoProperty(compressao, 'media_mpa', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="compressao.tracao_compressao" (input)="updateCompressaoProperty(compressao, 'tracao_compressao', $event)" type="number" class="form-control" /></td>
                                            </tr>
                                        </ng-template>
                                    </p-table>

                                </div>
                            </div>
                            
                            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                                <p-button 
                                    label="Salvar Ruptura a Compress√£o" 
                                    (onClick)="salvarRupturaCompressao()"
                                    severity="info"
                                    icon="pi pi-check" 
                                    iconPos="right" 
                                    tooltipPosition="top"
                                    pTooltip="Salvar Ruptura a Compress√£o"
                                    [style]="{'background-color': 'brown', 'border-color': 'purple'}"
                                />
                            </div>
                        </p-card>
                    </div>    
                </div>
            </div>
        </div>
       
    </p-drawer>

    <!-- retracao -->
    <p-drawer 
        [(visible)]="modalDadosLaudoRetracao" 
        position="full" >
    <p-toast />
         <div class="containerInterno w-12">
            <div class="background-form">
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">

                        <p-card class="card w-12 text-center card-superficial">
                            <ng-template #header>
                                <div class="header-retracao w-full text-center">
                                    <b>Determina√ß√£o da Varia√ß√£o Dimencional Linear (Reta√ß√£o/Expans√£o)</b>
                                </div>
                            </ng-template>
                            <div class="flex flex-row w-12 gap-3">
                                <div class="w-12">
                                    <p-table 
                                        [value]="linhasRetracao" 
                                        stripedRows
                                    >
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th>Data</th>
                                                <th>Idade</th>
                                                <th>M√©dia (mm/m)</th>
                                                <th>Desvio M√°ximo (mm/m)</th>
                                             
                                            </tr>
                                        </ng-template>

                                        <ng-template pTemplate="body" let-retracao let-i="rowIndex">
                                            <tr>
                                                <td><input pInputText  [(ngModel)]="retracao.data" type="date" /></td>
                                                <td><input pInputText [(ngModel)]="retracao.idade" type="number" /></td>
                                                <td><input pInputText [(ngModel)]="retracao.media" type="number" /></td>
                                                <td><input pInputText [(ngModel)]="retracao.desvio" type="number" /></td>
                                            </tr>
                                        </ng-template>
                                    </p-table>

                                </div>
                            </div>
                            
                            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                                <p-button 
                                    label="Salvar Varia√ß√£o Dimencional Linear" 
                                    (onClick)="salvarRetracao()"
                                    severity="info"
                                    icon="pi pi-check" 
                                    iconPos="right" 
                                    tooltipPosition="top"
                                    pTooltip="Salvar Varia√ß√£o Dimencional Linear"
                                    [style]="{'background-color': 'rgb(108, 165, 42)', 'border-color': 'rgb(108, 165, 42)'}"
                                />
                            </div>
                        </p-card>
                    </div>    
                </div>
            </div>
        </div>
       
    </p-drawer>

    <!-- elasticidade -->
    <p-drawer 
        [(visible)]="modalDadosLaudoElasticidade" 
        position="full" >
    <p-toast />
         <div class="containerInterno w-12">
            <div class="background-form">
                <div class="form-geral flex flex-column gap-3 w-12 lg:flex-row">
                    <div class="fg1 flex flex-column w-12 align-items-center">

                        <p-card class="card w-12 text-center card-superficial">
                            <ng-template #header>
                                <div class="header-elasticidade w-full text-center">
                                    <b>M√≥dulo de Elasticidade Din√¢mico</b>
                                </div>
                            </ng-template>
                            <div class="flex flex-row w-12 gap-3">
                                <div class="w-12">
                                    <p-table 
                                        [value]="linhasElasticidade" 
                                        stripedRows
                                    >
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th>Individual</th>
                                                <th>M√©dia (Mpa)</th>
                                                <th>Desvio Padr√£o (%)</th>
                                             
                                            </tr>
                                        </ng-template>

                                        <ng-template pTemplate="body" let-elasticidade let-i="rowIndex">
                                            <tr>
                                                <td><input [value]="elasticidade.individual" (input)="updateElasticidadeProperty(elasticidade, 'individual', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="elasticidade.media" (input)="updateElasticidadeProperty(elasticidade, 'media', $event)" type="number" class="form-control" /></td>
                                                <td><input [value]="elasticidade.desvio_padrao" (input)="updateElasticidadeProperty(elasticidade, 'desvio_padrao', $event)" type="number" class="form-control" /></td>
                                            </tr>
                                        </ng-template>
                                    </p-table>

                                </div>
                            </div>
                            
                            <div class=" flex w-12 gap-3 mt-4 justify-content-center text-center">
                                <p-button 
                                    label="Salvar M√≥dulo de Elasticidade Din√¢mico" 
                                    (onClick)="salvarElasticidade()"
                                    severity="info"
                                    icon="pi pi-check" 
                                    iconPos="right" 
                                    tooltipPosition="top"
                                    pTooltip="Salvar M√≥dulo de Elasticidade Din√¢mico"
                                    [style]="{'background-color': ' rgb(182, 109, 32)', 'border-color': ' rgb(182, 109, 32)'}"
                                />
                            </div>
                        </p-card>
                    </div>    
                </div>
            </div>
        </div>
       
    </p-drawer>

    <!-- √önico ConfirmDialog centralizado para toda a p√°gina -->
    <p-confirmDialog></p-confirmDialog>