<div class="menu">
    <ul nz-menu nzMode="horizontal" style="background-color:#f2f2f2;height: 40px;box-shadow: 2px 0 6px ; ">
        <li nz-menu-item nzMatchRouter="#">
            <a style="font-size: 13px;" routerLink="homeOrcamento">Início</a>
        </li>
        <li *ngIf="hasGroup(['Admin','RHGestor'])" nz-submenu nzTitle="Cadastros "  style="font-size: 13px; ">
            <ul>
                <li *ngIf="hasGroup(['Admin','RHGestor'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/baseOrcamentaria/orcamentoBase/raizAnalitica" >Raízes Analíticas</a>
                </li>
                <li *ngIf="hasGroup(['Admin','RHGestor'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/baseOrcamentaria/orcamentoBase/centrocustopai" >Centro de Custo Pai</a>
                </li>
                <li *ngIf="hasGroup(['Admin','RHGestor'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/baseOrcamentaria/orcamentoBase/centrocusto" >Centro de Custo </a>
                </li>
                <li *ngIf="hasGroup(['Admin','RHGestor'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/baseOrcamentaria/orcamentoBase/raizSintetica" >Raiz Sintética</a>
                </li>
                <li *ngIf="hasGroup(['Admin','RHGestor'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/baseOrcamentaria/orcamentoBase/contaContabil" >Conta Contabil</a>
                </li>
                <li *ngIf="hasGroup(['Admin','RHGestor'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/baseOrcamentaria/orcamentoBase/grupoItens" >Grupos de Itens</a>
                </li>
                <li *ngIf="hasGroup(['Admin','RHGestor'])" nz-menu-item  nzMatchRouter>
                    <a routerLink="/welcome/baseOrcamentaria/orcamentoBase/orcamentoBase" >Orçamento Base</a>
                </li>
            </ul>
        </li>    
    </ul>
</div>

<div class="titulo">
    <p-divider align="left" type="solid">
        <b>Cadastro de Orçamento Base</b>
    </p-divider>
</div>

<div class="container">
    <div class="formWrap">
        <form
            [formGroup]="registerForm"

        >
            <div class="form">
                <div class="row3">
                    <div class="coluna">
                        <div class="raiz">
                            <p-floatLabel>
                                <p-dropdown
                                    inputId="float-label" 
                                    [style]="{'width':'100%'}"
                                    [options]="ccsPai" 
                                    formControlName="ccPai"
                                    optionLabel="label"
                                    [(ngModel)]="selectedCcPai"
                                    (onChange)="onCcPaiSelecionado($event.value)"
                                    optionValue="id"
                                    [filter]="true" 
                                    filterBy="label"
                                    [showClear]="true"  
                                >
                                </p-dropdown>
                                <label for="float-label">Selecione o Centro de Custo Pai</label>
                            </p-floatLabel>
                        </div>
                    </div>
                    <div class="coluna">
                        <div class="raiz">
                            <p-floatLabel>
                                <p-dropdown
                                    inputId="float-label" 
                                    [style]="{'width':'100%'}"
                                    [options]="centrosCusto" 
                                    formControlName="centroCusto"
                                    optionLabel="nome"
                                    optionValue="id"
                                    [(ngModel)]="selectedCc"
                                    (onChange)="onCcSelecionado($event.value)" 
                                    [filter]="true" 
                                    filterBy="nome"
                                    [showClear]="true"                             
                                >
                                </p-dropdown>
                                <label for="float-label">Selecione o Centro de Custo</label>  
                            </p-floatLabel>  
                        </div>
                    </div>
                </div>
                <div class="row3">
                    <div class="coluna">
                        <div class="raizDetalhes" >
                            <div class="detalhes">
                                Nome:  <br>
                                Empresa:<br>
                                Filial: <br>
                                Área:<br>
                                Setor:<br>
                                Ambiente:<br>
                                
                            </div>    
                        
                            <div class="detalhes" *ngIf="ccsPaiDetalhes">
                                <strong>{{ ccsPaiDetalhes.nome }}</strong><br>
                                <strong>{{ ccsPaiDetalhes.empresa.nome }}</strong><br>
                                <input type="hidden" formControlName="empresa" [(ngModel)]="ccsPaiDetalhes.empresa.nome">
                                <strong>{{ ccsPaiDetalhes.filial.nome }}</strong><br>
                                <input type="hidden" formControlName="filial" [(ngModel)]="ccsPaiDetalhes.filial.nome">
                                <strong>{{ ccsPaiDetalhes.area.nome }}</strong><br>
                                <input type="hidden" formControlName="area" [(ngModel)]="ccsPaiDetalhes.area.nome">
                                <strong>{{ ccsPaiDetalhes.setor.nome }}</strong><br>
                                <input type="hidden" formControlName="setor" [(ngModel)]="ccsPaiDetalhes.setor.nome">
                                <strong>{{ ccsPaiDetalhes.ambiente.nome }}</strong><br>
                                <input type="hidden" formControlName="ambiente" [(ngModel)]="ccsPaiDetalhes.ambiente.nome">
                            </div>
                        </div>
                    </div>
                    <div class="coluna">
                        <div class="raizDetalhesDir" >
                            <div class="detalhes">
                                Codigo:  <br>
                                Nome:<br>
                                Gestor: <br>
                            </div>    
                            <div class="detalhes" *ngIf="ccsDetalhes">
                                <strong>{{ ccsDetalhes.codigo }}</strong><br>
                                <strong>{{ ccsDetalhes.nome }}</strong><br>
                                <input type="hidden" formControlName="gestor" [(ngModel)]="ccsDetalhes.gestor_detalhes.nome ">
                                <strong>{{ ccsDetalhes.gestor_detalhes.nome }}</strong><br>
                               
                            </div>
                        </div>
                        <div class="raizSinteticaDetalhes"> 
                            <div class="detalhes">
                                Raiz Sintetica: <br>
                                Raiz Sintetica Descrição:
                            </div> 
                            <div class="detalhes" *ngIf="raizSinteticaDetalhes">
                                <strong>{{ raizSinteticaDetalhes.raiz_contabil }}</strong><br>
                                <input type="hidden" formControlName="raizSintetica" [(ngModel)]="raizSinteticaDetalhes.raiz_contabil">
                                <strong>{{ raizSinteticaDetalhes.descricao }}</strong>
                                <input type="hidden" formControlName="raizSinteticaDesc" [(ngModel)]="raizSinteticaDetalhes.descricao">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row3">        
                    <div class="coluna">   
                        <div class="raiz">
                            <p-floatLabel>
                                <p-dropdown
                                    [style]="{'width':'100%'}"
                                    [options]="baseOrcamentos"
                                    formControlName="baseOrcamento"
                                    optionLabel="value"
                                    optionValue="value"
                                    inputId="float-label"
                                >
                                </p-dropdown>
                                <label for="float-label">Selecione a Base de Orçamento</label>
                            </p-floatLabel>    
                        </div>
                        <div class="raizDetalhesCc">
                            <div class="detalhes">
                                Raiz Contabil Grupo:
                            </div>
                            <div class="detalhes">
                                <strong>{{ rcGrupoDesc }}</strong>
                                <input type="hidden" formControlName="raizContGrupoDesc" [(ngModel)]="rcGrupoDesc">
                            </div>
                        </div> 
                    </div>
                    <div class="coluna">
                        <div class="raiz">
                            <p-floatLabel>
                                <p-dropdown
                                    inputId="float-label" 
                                    [style]="{'width':'100%'}"
                                    [options]="raizesAnaliticas" 
                                    formControlName="raizAnalitica"
                                    optionLabel="label"
                                    
                                    [(ngModel)]="selectedRaizAnalitica"
                                    (onChange)="onRaizAnaliticaSelecionada($event.value)"
                                    [filter]="true" 
                                    filterBy="descricao"
                                    [showClear]="true" 
                                >
                                    <ng-template pTemplate="filter" let-options="options">
                                        <div class="flex gap-1">
                                            <div class="p-inputgroup" (click)="$event.stopPropagation()">
                                                <span class="p-inputgroup-addon"><i class="pi pi-search"></i></span>
                                                <input 
                                                    type="text"
                                                    pInputText
                                                    placeholder="Filter"
                                                    [(ngModel)]="filterValue"
                                                    (keyup)="customFilterFunction($event, options)" />
                                            </div>
                                            <button pButton icon="pi pi-times" (click)="resetFunction(options)"></button>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                                <label for="float-label">Selecione a Raíz Analítica</label>
                                <input type="hidden" formControlName="raizContGrupoDesc" [(ngModel)]="contaContabil">
                            </p-floatLabel>
                        </div> 
                        <div class="raizDetalhesCc">
                            <div class="detalhes">
                                Conta Contábil:
                            </div>
                            <div class="detalhes">
                                <strong>{{ contaContabil }}</strong>
                                <input type="hidden" formControlName="raizContGrupoDesc" [(ngModel)]="contaContabil">
                            </div>
                        </div>  
                    </div>    
                </div><!--endRow-->  
                <div class="row3">
                    <div class="coluna">
                        <div class="raiz">
                            <p><label for="sit">Suplementação </label></p>
                                <p-inputSwitch 
                                    id="sit"
                                    formControlName="suplementacao"
                                >
                                </p-inputSwitch>
                        </div>
                    </div>
                    <div class="coluna">
                        <div class="raiz">
                            <p><label for="sal">Valor</label></p>    
                            <p-inputNumber
                                [style]="{'width':'100%'}" 
                                id="sal"
                                formControlName="valor" 
                                inputId="currency-us" 
                                mode="currency" 
                                currency="BRL" 
                                locale="pt-BR" 
                            />  
                        </div>
                    </div>
                    <div class="coluna">
                        <div class="raiz">
                            <label class="mb-2 block font-bold" for="ano">
                                Ano<br>
                            </label>
                            <p-inputNumber 
                                mode="decimal"
                                [showButtons]="true" 
                                inputId="ano" 
                                [min]="2024" 
                                [max]="2999"
                                [useGrouping]="false" 
                            />
                        </div>
                    </div>
                </div> <!--endRow>-->
                <div class="row3">
                    <div class="coluna">
                        <div class="raizDetalhesCc">
                            <div class="detalhes">
                                Id Base:
                            </div>
                            <div class="detalhes">
                                <strong>{{ idBase }}</strong>
                            </div>
                        </div> 
                    </div>
                    <div class="coluna">
                        <div class="raiz">
                            <p-floatLabel>
                                <p-dropdown
                                    inputId="float-label"
                                    [style]="{'width':'100%'}"
                                    [options]="recorrencias" 
                                    formControlName="periodicidade"
                                    optionLabel="value"
                                    optionValue="key"
                                >
                                </p-dropdown>
                                <label for="float-label">Selecione a Periodicidade</label>
                            </p-floatLabel> 
                        </div>
                    </div>
                </div>
                <div class="row3">    
                    <div class="coluna">
                            <div class="raiz" *ngIf="registerForm.get('periodicidade')?.value === 'mensal'">
                                <p-floatLabel>
                                    <p-dropdown
                                    inputId="float-label"
                                        [style]="{'width':'100%'}"
                                        [options]="mensalTipos"
                                        formControlName="mensalTipo"
                                        optionLabel="value"
                                        optionValue="key"
                                    >
                                    </p-dropdown>
                                    <label for="float-label">Selecione o Tipo de Ocorrência</label>
                                </p-floatLabel>    
                            </div>    
                    </div>
                    <div class="coluna">
                        <div class="raiz" *ngIf="registerForm.get('mensalTipo')?.value === 'especifico'">
                            <p-floatLabel>
                                <p-dropdown
                                    inputId="float-label"
                                    [style]="{'width':'100%'}"
                                    [options]="meses"
                                    formControlName="mesEspecifico"
                                    optionLabel="value"
                                    optionValue="key"
                                >
                                </p-dropdown>
                                <label for="float-label">Selecione o Mês</label>
                            </p-floatLabel>    
                        </div>
                        <div class="raiz" *ngIf="registerForm.get('mensalTipo')?.value === 'recorrente'">
                            <p-floatLabel>    
                                <p-multiSelect
                                    [style]="{'width':'100%'}"
                                    [options]="meses"
                                    formControlName="mesesRecorrentes"
                                    optionLabel="value"
                                    optionValue="key"
                                    inputId="float-label"
                                >
                                </p-multiSelect>
                                <label for="float-label">Selecione os Meses</label>
                            </p-floatLabel>    
                        </div>
                    </div>
                </div>  
            </div>
        </form>
        <div class="botoes-form">
            <p-toast></p-toast>
            <div class="btnsec" >
                <p>Limpar</p>
            </div>
            <div class="btnpri">
                <p>Salvar</p>            
            </div>
        
        </div>
    </div>   
    <pre>{{ registerForm.value | json }}</pre>
</div>
